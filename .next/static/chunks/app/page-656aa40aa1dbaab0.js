(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{1120:(e,t,s)=>{"use strict";s.d(t,{T:()=>i});var a=s(5155),r=s(2115),l=s(4269);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...r})});i.displayName="Textarea"},1647:(e,t,s)=>{"use strict";s.d(t,{E:()=>n});var a=s(5155),r=s(2115),l=s(3101),i=s(4269);let o=(0,l.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}}),n=r.forwardRef((e,t)=>{let{className:s,variant:r,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,i.cn)(o({variant:r}),s),...l})});n.displayName="Badge"},1834:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>m,L3:()=>x,c7:()=>u,lG:()=>n,rr:()=>p});var a=s(5155),r=s(2115),l=s(9511),i=s(5229),o=s(4269);let n=l.bL;l.l9;let c=l.ZL;l.bm;let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.hJ,{ref:t,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});d.displayName=l.hJ.displayName;let m=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(d,{}),(0,a.jsxs)(l.UC,{ref:t,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...n,children:[r,(0,a.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[(0,a.jsx)(i.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=l.UC.displayName;let u=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};u.displayName="DialogHeader";let x=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.hE,{ref:t,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});x.displayName=l.hE.displayName;let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.VY,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",s),...r})});p.displayName=l.VY.displayName},2847:(e,t,s)=>{Promise.resolve().then(s.bind(s,7915))},3553:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var a=s(5155),r=s(6948),l=s(3998),i=s(1362);let o=e=>{let{bookingDetails:t,onClose:s}=e;return(0,a.jsxs)(r.Zp,{className:"p-8 shadow-metal bg-card/50 backdrop-blur max-w-2xl mx-auto",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)(i.A,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-3xl font-display font-bold text-gradient-metal mb-2",children:"Booking Confirmed!"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Your booking request has been submitted successfully"})]}),(0,a.jsxs)("div",{className:"space-y-4 bg-secondary/30 p-6 rounded-lg mb-6",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg mb-3",children:"Booking Summary"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Pickup Location"}),(0,a.jsx)("p",{className:"font-medium",children:t.pickupLocation})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Drop-off Location"}),(0,a.jsx)("p",{className:"font-medium",children:t.dropoffLocation})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Date & Time"}),(0,a.jsxs)("p",{className:"font-medium",children:[t.pickupDate," at ",t.pickupTime]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Vehicle"}),(0,a.jsx)("p",{className:"font-medium",children:t.vehicleName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Customer Name"}),(0,a.jsx)("p",{className:"font-medium",children:t.customerName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Email"}),(0,a.jsx)("p",{className:"font-medium",children:t.customerEmail})]})]}),(0,a.jsxs)("div",{className:"pt-4 border-t border-border flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-lg font-semibold",children:"Total Price:"}),(0,a.jsxs)("span",{className:"text-3xl font-display font-bold text-accent",children:["$",t.totalPrice]})]})]}),(0,a.jsxs)("div",{className:"space-y-3 text-sm text-muted-foreground",children:[(0,a.jsxs)("p",{children:["✓ A confirmation email has been sent to ",t.customerEmail]}),(0,a.jsx)("p",{children:"✓ Our team will contact you shortly to confirm the details"}),(0,a.jsx)("p",{children:"✓ You will receive payment instructions before your journey"})]}),(0,a.jsx)(l.$,{onClick:s,className:"w-full mt-6 gradient-accent shadow-glow",size:"lg",children:"Book Another Journey"})]})}},5119:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var a=s(5155),r=s(2115);let l=e=>{let{images:t,autoPlayInterval:s=3e3,children:l,className:i="",overlayStrength:o="medium",showScrollIndicator:n=!1}=e,[c,d]=(0,r.useState)(0),[m,u]=(0,r.useState)(!0),x={light:"bg-gradient-to-b from-black/40 via-black/30 to-black/60",medium:"bg-gradient-to-b from-black/50 via-black/40 to-black/70",strong:"bg-gradient-to-b from-black/60 via-black/50 to-black/80"},p=(0,r.useCallback)(()=>{d(e=>e===t.length-1?0:e+1)},[t.length]),h=(0,r.useCallback)(()=>{d(e=>0===e?t.length-1:e-1)},[t.length]);return(0,r.useEffect)(()=>{if(!m)return;let e=setInterval(()=>{p()},s);return()=>clearInterval(e)},[m,s,p]),(0,r.useEffect)(()=>{let e=e=>{"ArrowLeft"===e.key?(h(),u(!1)):"ArrowRight"===e.key&&(p(),u(!1))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[p,h]),(0,a.jsxs)("div",{className:"relative w-full h-full overflow-hidden ".concat(i),children:[(0,a.jsx)("div",{className:"absolute inset-0 z-0",children:t.map((e,t)=>(0,a.jsxs)("div",{className:"absolute inset-0 transition-opacity duration-1000 ease-in-out ".concat(t===c?"opacity-100":"opacity-0"),children:[(0,a.jsx)("img",{src:e,alt:"Slide ".concat(t+1),className:"w-full h-full object-cover transform transition-transform duration-[7000ms] ease-out ".concat(t===c?"scale-105":"scale-100"),loading:0===t?"eager":"lazy",decoding:"async",fetchPriority:0===t?"high":"auto",style:{imageRendering:"-webkit-optimize-contrast",backfaceVisibility:"hidden",transform:"translateZ(0)"}}),(0,a.jsx)("div",{className:"absolute inset-0 ".concat(x[o])})]},t))}),l&&(0,a.jsx)("div",{className:"relative z-10 h-full",children:l}),(0,a.jsx)("div",{className:"absolute bottom-8 left-0 right-0 z-20 flex items-center justify-center gap-2",children:t.map((e,t)=>(0,a.jsx)("button",{onClick:()=>{d(t),u(!1),setTimeout(()=>u(!0),1e4)},className:"transition-all duration-300 ".concat(t===c?"w-6 h-2 bg-accent rounded-full":"w-2 h-2 bg-white/60 hover:bg-white/80 rounded-full"),"aria-label":"Go to slide ".concat(t+1),"aria-current":t===c},t))}),n&&(0,a.jsx)("div",{className:"absolute bottom-24 left-1/2 -translate-x-1/2 z-20 animate-bounce",children:(0,a.jsx)("div",{className:"w-6 h-10 border-2 border-white/50 rounded-full flex justify-center",children:(0,a.jsx)("div",{className:"w-1 h-3 bg-white rounded-full mt-2"})})})]})}},7915:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eB});var a=s(5155),r=s(2619),l=s.n(r),i=s(3947),o=s(5276),n=s(1169),c=s(1873),d=s(2331),m=s(5870),u=s(1368),x=s(7910),p=s(4947),h=s(6983),g=s(9141),f=s(9347),v=s(2472),j=s(2529),b=s(7703),y=s(3166),N=s(8854),w=s(6948),k=s(6244);let _=()=>{var e,t,s;let{data:r}=(0,k.y)("home"),l=(0,k.TP)(r,k.Sz),i=(null==(e=l.service_highlights)?void 0:e.services)||[];return(0,a.jsx)("section",{className:"py-24 md:py-28 lg:py-32 bg-muted/30 relative",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 relative",children:[(0,a.jsxs)("div",{className:"text-center mb-16 animate-fade-in",children:[(0,a.jsx)("h2",{className:"text-4xl md:text-5xl font-display font-bold mb-4 text-foreground",children:(null==(t=l.service_highlights)?void 0:t.title)||"Why Choose Drive917"}),(0,a.jsx)("div",{className:"flex items-center justify-center mt-6",children:(0,a.jsx)("div",{className:"h-[1px] w-24 bg-gradient-to-r from-transparent via-primary to-transparent"})}),(0,a.jsx)("p",{className:"text-base md:text-lg text-foreground/70 max-w-3xl mx-auto font-light mt-6",children:(null==(s=l.service_highlights)?void 0:s.subtitle)||"Delivering excellence through premium vehicle rentals and exceptional service."})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8 max-w-7xl mx-auto",children:i.map((e,t)=>{var s;let r=(s=e.icon,({ThumbsUp:o.A,Users:n.A,MapPin:c.A,Baby:d.A,Settings:m.A,Headphones:u.A,Shield:x.A,Car:p.A,Clock:h.A,Phone:g.A,Star:f.A,Award:v.A,CheckCircle:j.A,Fuel:b.A,Wifi:y.A,Crown:N.A})[s]||o.A);return(0,a.jsx)(w.Zp,{className:"relative overflow-hidden p-8 lg:p-10 bg-card border border-border hover:border-primary/30 transition-all duration-500 hover:-translate-y-2 shadow-[0_4px_20px_rgba(0,0,0,0.08)] dark:shadow-[0_4px_20px_rgba(0,0,0,0.3)] hover:shadow-glow animate-fade-in-up group rounded-2xl",style:{animationDelay:"".concat(.1*t,"s")},children:(0,a.jsxs)("div",{className:"relative space-y-5 flex flex-col",children:[(0,a.jsx)("div",{className:"relative w-16 h-16 rounded-full bg-primary flex items-center justify-center shadow-glow group-hover:shadow-glow transition-all duration-500",children:(0,a.jsx)(r,{className:"w-8 h-8 text-primary-foreground",strokeWidth:2,"aria-hidden":"true"})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-2xl font-display font-bold text-foreground leading-tight",children:e.title}),(0,a.jsx)("p",{className:"text-foreground/70 leading-relaxed text-[15px]",children:e.description})]})]})},t)})})]})})};var P=s(2115),S=s(9156);let D=()=>{var e;let[t,s]=(0,P.useState)([]),[r,l]=(0,P.useState)(0),{data:i}=(0,k.y)("home"),o=(0,k.TP)(i,k.Sz);(0,P.useEffect)(()=>{n()},[]),(0,P.useEffect)(()=>{if(0===t.length)return;let e=Math.ceil(t.length/3),s=setInterval(()=>{l(t=>(t+1)%e)},5e3);return()=>clearInterval(s)},[t.length]);let n=async()=>{let{data:e}=await S.N.from("testimonials").select("*").order("created_at",{ascending:!1});e&&(console.log("Loaded testimonials:",e.length,e),s(e))};if(0===t.length)return null;let c=Math.ceil(t.length/3),d=3*r,m=t.slice(d,d+3);return console.log("Active Index:",r),console.log("Total testimonials:",t.length),console.log("Total pages:",c),console.log("Visible testimonials:",m.map(e=>e.author)),(0,a.jsx)("section",{className:"py-24 md:py-28 lg:py-32 bg-muted/20",children:(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[(0,a.jsxs)("div",{className:"text-center mb-16 animate-fade-in",children:[(0,a.jsx)("h2",{className:"text-4xl md:text-5xl font-display font-bold mb-4 text-foreground",children:(null==(e=o.testimonials_header)?void 0:e.title)||"Why Dallas Drivers Choose Drive917"}),(0,a.jsx)("div",{className:"flex items-center justify-center mt-6",children:(0,a.jsx)("div",{className:"h-[1px] w-24 bg-gradient-to-r from-transparent via-primary to-transparent"})})]}),(0,a.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-7xl mx-auto",children:m.map((e,t)=>(0,a.jsxs)(w.Zp,{className:"p-8 bg-card shadow-[0_4px_20px_rgba(0,0,0,0.08)] dark:shadow-[0_4px_20px_rgba(0,0,0,0.3)] hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] dark:hover:shadow-[0_8px_30px_rgba(0,0,0,0.4)] transition-all duration-300 hover:-translate-y-1 flex flex-col animate-fade-in border border-border",style:{animationDelay:"".concat(.1*t,"s")},children:[(0,a.jsx)("div",{className:"flex gap-1 mb-6",children:[...Array(e.stars||5)].map((e,t)=>(0,a.jsx)(f.A,{className:"w-5 h-5 fill-primary text-primary","aria-hidden":"true"},t))}),(0,a.jsxs)("p",{className:"text-foreground/80 mb-6 italic leading-relaxed min-h-[7rem] text-base break-words overflow-wrap-anywhere hyphens-auto",children:['"',e.review,'"']}),(0,a.jsxs)("div",{className:"border-t border-border pt-4 mt-auto",children:[(0,a.jsx)("p",{className:"font-bold text-foreground font-display text-lg",children:e.author}),e.company_name&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground uppercase tracking-wider mt-1 font-light",children:e.company_name})]})]},e.id))},r),(0,a.jsx)("div",{className:"flex justify-center gap-3 mt-12",children:[...Array(c)].map((e,t)=>(0,a.jsx)("button",{onClick:()=>l(t),className:"h-2 rounded-full transition-all duration-300 ".concat(t===r?"bg-primary w-8":"bg-muted-foreground/30 w-2 hover:bg-muted-foreground/50"),"aria-label":"View page ".concat(t+1)},t))})]})})};var C=s(8455),A=s(1192),L=s(3998),R=s(5060);let I=()=>{let{settings:e}=(0,R.y)(),t=e.phone.replace(/[^\d+]/g,"");return(0,a.jsx)("div",{className:"lg:hidden fixed bottom-4 right-4 z-40",children:(0,a.jsx)("a",{href:"tel:".concat(t),"aria-label":"Call us",children:(0,a.jsx)(L.$,{size:"lg",className:"gradient-accent shadow-glow rounded-full w-14 h-14 p-0",children:(0,a.jsx)(g.A,{className:"w-6 h-6"})})})})};var E=s(562);let M=()=>{let[e,t]=(0,P.useState)(!1);return(0,P.useEffect)(()=>{let e=()=>{window.pageYOffset>300?t(!0):t(!1)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),(0,a.jsx)(a.Fragment,{children:e&&(0,a.jsx)(L.$,{onClick:()=>{window.scrollTo({top:0,behavior:"smooth"})},size:"lg",className:"fixed bottom-20 right-4 lg:bottom-4 z-50 rounded-full w-14 h-14 p-0 shadow-metal hover-lift","aria-label":"Scroll to top",children:(0,a.jsx)(E.A,{className:"w-6 h-6"})})})};var T=s(3664);let $=()=>{var e,t,s,r;let{data:l}=(0,k.y)("home"),i=(0,k.TP)(l,k.Sz),{settings:o}=(0,R.y)(),n=o.phone.replace(/[^\d+]/g,"");return(0,a.jsx)("section",{className:"py-16 bg-background",children:(0,a.jsx)("div",{className:"container mx-auto px-4",children:(0,a.jsx)(w.Zp,{className:"max-w-4xl mx-auto shadow-lg border-border/50 bg-card",children:(0,a.jsx)(w.Wu,{className:"p-8 md:p-12",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-8",children:[(0,a.jsxs)("div",{className:"flex-1 text-center md:text-left",children:[(0,a.jsx)("h2",{className:"text-3xl md:text-4xl font-display font-bold text-foreground mb-3",children:(null==(e=i.contact_card)?void 0:e.title)||"Have Questions About Your Rental?"}),(0,a.jsx)("p",{className:"text-lg text-muted-foreground",children:(null==(t=i.contact_card)?void 0:t.description)||"We're here to help 7 days a week. Reach out to our Dallas team for quick answers and booking support."})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 shrink-0",children:[(0,a.jsx)("a",{href:"tel:".concat(n),children:(0,a.jsxs)(L.$,{size:"lg",className:"bg-primary hover:bg-primary/90 text-primary-foreground font-semibold px-8 py-6 shadow-md hover:shadow-lg transition-all",children:[(0,a.jsx)(g.A,{className:"w-5 h-5 mr-2"}),(null==(s=i.contact_card)?void 0:s.call_button_text)||"Call Now"]})}),(0,a.jsx)("a",{href:"mailto:".concat(o.email),children:(0,a.jsxs)(L.$,{size:"lg",variant:"outline",className:"border-2 border-foreground text-foreground hover:bg-foreground hover:text-background font-semibold px-8 py-6 transition-all",children:[(0,a.jsx)(T.A,{className:"w-5 h-5 mr-2"}),(null==(r=i.contact_card)?void 0:r.email_button_text)||"Email Us"]})})]})]})})})})})};var F=s(5142),z=s(6444),V=s(1186),q=s(7599),G=s(4269);let O=P.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(q.bL,{className:(0,G.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",s),...r,ref:t,children:(0,a.jsx)(q.zi,{className:(0,G.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});O.displayName=q.bL.displayName;var Z=s(276),B=s(6333);function J(e){let{value:t="",onChange:s,disabled:r,className:l,id:i}=e,[o,n]=P.useState(!1),[c,d]=P.useState("12"),[m,u]=P.useState("00"),[x,p]=P.useState("PM");return P.useEffect(()=>{if(t){let[e,s]=t.split(":"),a=parseInt(e,10);0===a?(d("12"),p("AM")):12===a?(d("12"),p("PM")):a>12?(d((a-12).toString().padStart(2,"0")),p("PM")):(d(e),p("AM")),u(s)}},[t]),(0,a.jsxs)(B.AM,{open:o,onOpenChange:n,children:[(0,a.jsx)(B.Wv,{asChild:!0,children:(0,a.jsxs)(L.$,{id:i,variant:"outline",disabled:r,className:(0,G.cn)("w-full justify-start text-left font-normal h-10 hover:!bg-transparent hover:!text-foreground",!t&&"text-muted-foreground",l),children:[(0,a.jsx)(h.A,{className:"mr-2 h-4 w-4"}),t?(()=>{let[e,s]=t.split(":"),a=parseInt(e,10);return"".concat(0===a?12:a>12?a-12:a,":").concat(s," ").concat(a>=12?"PM":"AM")})():"Select time"]})}),(0,a.jsx)(B.hl,{className:"w-auto p-4",align:"start",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium",children:"Select Time"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z.J,{htmlFor:"hours",className:"text-xs",children:"Hours"}),(0,a.jsx)(F.p,{id:"hours",type:"number",min:"1",max:"12",value:c,onChange:e=>{let t=parseInt(e.target.value,10);if(isNaN(t))return void d("");t>12&&(t=12),t<1&&(t=1),d(t.toString().padStart(2,"0"))},className:"w-16 text-center"})]}),(0,a.jsx)("div",{className:"pt-6 text-xl font-bold",children:":"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z.J,{htmlFor:"minutes",className:"text-xs",children:"Minutes"}),(0,a.jsx)(F.p,{id:"minutes",type:"number",min:"0",max:"59",value:m,onChange:e=>{let t=parseInt(e.target.value,10);if(isNaN(t))return void u("00");t>59&&(t=59),t<0&&(t=0),u(t.toString().padStart(2,"0"))},className:"w-16 text-center"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z.J,{className:"text-xs",children:"Period"}),(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)(L.$,{type:"button",variant:"AM"===x?"default":"outline",size:"sm",onClick:()=>p("AM"),className:(0,G.cn)("w-16 h-8","AM"===x&&"bg-accent text-accent-foreground hover:bg-accent/90"),children:"AM"}),(0,a.jsx)(L.$,{type:"button",variant:"PM"===x?"default":"outline",size:"sm",onClick:()=>p("PM"),className:(0,G.cn)("w-16 h-8","PM"===x&&"bg-accent text-accent-foreground hover:bg-accent/90"),children:"PM"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z.J,{className:"text-xs",children:"Quick Select"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2",children:[{label:"9:00 AM",h:"09",m:"00",p:"AM"},{label:"12:00 PM",h:"12",m:"00",p:"PM"},{label:"3:00 PM",h:"03",m:"00",p:"PM"},{label:"6:00 PM",h:"06",m:"00",p:"PM"},{label:"9:00 PM",h:"09",m:"00",p:"PM"},{label:"Now",h:"",m:"",p:""}].map(e=>{var t,s,r;let l=(t=e.h,s=e.m,r=e.p,(""!==t||""!==s||""!==r)&&c===t&&m===s&&x===r);return(0,a.jsx)(L.$,{type:"button",variant:l?"default":"outline",size:"sm",onClick:()=>{if("Now"===e.label){let e=new Date,t=e.getHours(),s=e.getMinutes();d((0===t?12:t>12?t-12:t).toString().padStart(2,"0")),u(s.toString().padStart(2,"0")),p(t>=12?"PM":"AM")}else d(e.h),u(e.m),p(e.p)},className:(0,G.cn)("text-xs",l&&"bg-accent text-accent-foreground hover:bg-accent/90"),children:e.label},e.label)})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(L.$,{type:"button",variant:"outline",size:"sm",onClick:()=>n(!1),className:"flex-1",children:"Cancel"}),(0,a.jsx)(L.$,{type:"button",size:"sm",onClick:()=>{let e=parseInt(c,10);"AM"===x?12===e&&(e=0):12!==e&&(e+=12);let t="".concat(e.toString().padStart(2,"0"),":").concat(m);null==s||s(t),n(!1)},className:"flex-1 bg-accent text-accent-foreground hover:bg-accent/90",children:"Apply"})]})]})})]})}var Y=s(3026);let U=P.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsxs)(Y.bL,{ref:t,className:(0,G.cn)("relative flex w-full touch-none select-none items-center",s),...r,children:[(0,a.jsx)(Y.CC,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,a.jsx)(Y.Q6,{className:"absolute h-full bg-primary"})}),(0,a.jsx)(Y.zi,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});U.displayName=Y.bL.displayName;var W=s(1647),H=s(8720);s(2181),s(9587);var Q=s(1524),K=s(5917),X=s(6485),ee=s(7937),et=s(368),es=s(6651),ea=s(6630),er=s(5530),el=s(3),ei=s(5229),eo=s(6132),en=s(2516),ec=s(9559),ed=s(5282),em=s(2186),eu=s(3553),ex=s(1834),ep=s(1120);let eh=e=>{let{open:t,onOpenChange:s,customerName:r="",customerEmail:l="",customerPhone:i="",bookingDetails:o="",fullBookingData:n,onSubmit:c}=e,[d,m]=(0,P.useState)(!1),[u,p]=(0,P.useState)({}),[h,g]=(0,P.useState)({name:"",email:"",phone:"",requirements:"",threatLevel:""});(0,P.useEffect)(()=>{t&&(g({name:r,email:l,phone:i,requirements:"",threatLevel:""}),p({}))},[t]);let f=(e,t)=>{let s="";if("name"===e){let e=t.trim();e?e.length<2?s="Name must be at least 2 characters":/^[a-zA-Z\s\-']+$/.test(e)?/[a-zA-Z]{2,}/.test(e)?e.replace(/[\s\-']/g,"").length<2&&(s="Name must have actual alphabetic content"):s="Name must contain at least 2 alphabetic characters":s="Name must contain only letters, spaces, hyphens, and apostrophes":s="Please enter your full name"}else if("email"===e)t.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)||(s="Please enter a valid email address"):s="Please enter your email address";else if("phone"===e){let e=t.trim();if(e){let t=e.replace(/[\s\-()]/g,""),a=(t.match(/\d/g)||[]).length;a<7||a>15?s="Please enter a valid phone number (7-15 digits)":t.startsWith("+")&&!/^\+\d+$/.test(t)?s="Invalid phone number format":t.startsWith("+")||/^\d+$/.test(t.replace(/[\s\-()]/g,""))||(s="Phone number should contain only digits")}else s="Please enter your phone number"}else"threatLevel"!==e||t&&""!==t.trim()||(s="Please select a threat assessment level");p(t=>{if(s)return{...t,[e]:s};{let s={...t};return delete s[e],s}})},v=async()=>{let e={},t=h.name.trim();t?t.length<2?e.name="Name must be at least 2 characters":/^[a-zA-Z\s\-']+$/.test(t)?/[a-zA-Z]{2,}/.test(t)?t.replace(/[\s\-']/g,"").length<2&&(e.name="Name must have actual alphabetic content"):e.name="Name must contain at least 2 alphabetic characters":e.name="Name must contain only letters, spaces, hyphens, and apostrophes":e.name="Please enter your full name",h.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(h.email)||(e.email="Please enter a valid email address"):e.email="Please enter your email address";let a=h.phone.trim();if(a){let t=a.replace(/[\s\-()]/g,""),s=(t.match(/\d/g)||[]).length;s<7||s>15?e.phone="Please enter a valid phone number (7-15 digits)":t.startsWith("+")&&!/^\+\d+$/.test(t)?e.phone="Invalid phone number format":t.startsWith("+")||/^\d+$/.test(t.replace(/[\s\-()]/g,""))||(e.phone="Phone number should contain only digits")}else e.phone="Please enter your phone number";if(h.threatLevel&&""!==h.threatLevel.trim()||(e.threatLevel="Please select a threat assessment level"),Object.keys(e).length>0)return void p(e);p({}),m(!0);try{let e={interested:!0,customer_name:h.name,customer_email:h.email,customer_phone:h.phone,threat_level:h.threatLevel||"Not Sure",requirements:h.requirements,submitted_at:new Date().toISOString()},t="ilyasghulam32@gmail.com",a={adminEmail:t,customerName:h.name,customerEmail:h.email,customerPhone:h.phone,enquiryDetails:{serviceType:"Combined with Chauffeur Service",date:(null==n?void 0:n.pickupDate)||new Date().toLocaleDateString(),startTime:(null==n?void 0:n.pickupTime)||"TBD",durationHours:"TBD",primaryLocation:(null==n?void 0:n.pickupLocation)||"N/A",secondaryLocation:(null==n?void 0:n.dropoffLocation)||"",agentsRequired:"TBD",riskLevel:h.threatLevel||"Not Sure",notes:"\nCOMBINED WITH CHAUFFEUR BOOKING:\nVehicle: ".concat((null==n?void 0:n.vehicleName)||"N/A","\nPassengers: ").concat((null==n?void 0:n.passengers)||"N/A","\n\nSPECIFIC REQUIREMENTS:\n").concat(h.requirements||"None specified","\n          ").trim()},supportEmail:t};await S.N.functions.invoke("send-cp-enquiry",{body:a}),c&&c(e),H.oR.success("Close protection interest recorded! Our team will contact you shortly."),s(!1),g({name:r,email:l,phone:i,requirements:"",threatLevel:""})}catch(e){H.oR.error("Failed to submit enquiry. Please try again."),console.error("CP Enquiry error:",e)}finally{m(!1)}};return(0,a.jsx)(ex.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)(ex.Cf,{className:"sm:max-w-[500px] max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(ex.c7,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x.A,{className:"w-6 h-6 text-primary"}),(0,a.jsx)(ex.L3,{className:"text-2xl",children:"Close Protection Services"})]}),(0,a.jsx)(ex.rr,{className:"text-base pt-2",children:"Add discreet security for your journey. Our trained professionals provide executive protection tailored to your needs."})]}),(0,a.jsxs)("form",{name:"closeProtectionForm",onSubmit:e=>{e.preventDefault(),v()},children:[(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z.J,{htmlFor:"cp-name",children:"Name *"}),(0,a.jsx)(F.p,{id:"cp-name",name:"cp-modal-name",autoComplete:"off",value:h.name,onChange:e=>{let t=e.target.value.replace(/[^a-zA-Z\s\-']/g,"");g({...h,name:t}),f("name",t)},onBlur:()=>f("name",h.name),placeholder:"Your name",className:u.name?"border-destructive":""}),u.name&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:u.name})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z.J,{htmlFor:"cp-email",children:"Email *"}),(0,a.jsx)(F.p,{id:"cp-email",name:"cp-modal-email",type:"email",autoComplete:"off",value:h.email,onChange:e=>{let t=e.target.value;g({...h,email:t}),f("email",t)},onBlur:()=>f("email",h.email),placeholder:"your@email.com",className:u.email?"border-destructive":""}),u.email&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:u.email})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z.J,{htmlFor:"cp-phone",children:"Phone *"}),(0,a.jsx)(F.p,{id:"cp-phone",name:"cp-modal-phone",type:"tel",autoComplete:"off",value:h.phone,onChange:e=>{let t=e.target.value.replace(/[^\d\s+\-()]/g,"");g({...h,phone:t}),f("phone",t)},onBlur:()=>f("phone",h.phone),placeholder:"Enter phone number",className:u.phone?"border-destructive":""}),u.phone&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:u.phone})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z.J,{htmlFor:"cp-threat",children:"Threat Assessment *"}),(0,a.jsxs)(V.l6,{value:h.threatLevel,onValueChange:e=>{g({...h,threatLevel:e}),f("threatLevel",e)},children:[(0,a.jsx)(V.bq,{id:"cp-threat",className:u.threatLevel?"border-destructive":"",children:(0,a.jsx)(V.yv,{placeholder:"Select threat level"})}),(0,a.jsxs)(V.gC,{children:[(0,a.jsx)(V.eb,{value:"Low",children:"Low - General safety preference"}),(0,a.jsx)(V.eb,{value:"Medium",children:"Medium - Some specific concerns"}),(0,a.jsx)(V.eb,{value:"High",children:"High - Known security risks"}),(0,a.jsx)(V.eb,{value:"Not Sure",children:"Not Sure - Need assessment"})]})]}),u.threatLevel&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:u.threatLevel})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z.J,{htmlFor:"cp-requirements",children:"Specific Requirements"}),(0,a.jsx)(ep.T,{id:"cp-requirements",value:h.requirements,onChange:e=>{g({...h,requirements:e.target.value}),u.requirements&&p({...u,requirements:""})},placeholder:"Any specific security concerns or requirements...",rows:3,className:u.requirements?"border-destructive":""}),u.requirements&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:u.requirements})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(L.$,{variant:"outline",onClick:()=>s(!1),className:"flex-1",disabled:d,children:"Cancel"}),(0,a.jsx)(L.$,{type:"submit",className:"flex-1 gradient-accent",disabled:d,children:d?"Submitting...":"Submit Enquiry"})]})]})]})})};var eg=s(3696),ef=s(63),ev=s(3457),ej=s(508),eb=s(5299),ey=s(8519),eN=s(9715),ew=s(9867),ek=s(2987),e_=s(4222);let eP=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),eS=e=>{var t;let{invoice:s,customer:r,vehicle:l,rental:i,protectionPlan:o}=e,n=l.make&&l.model?"".concat(l.make," ").concat(l.model):l.reg,c=null!=(t=null==o?void 0:o.rentalFee)?t:s.subtotal;return(0,a.jsxs)("div",{className:"p-8 bg-white text-black",children:[(0,a.jsxs)("div",{className:"border-b border-gray-300 pb-6 mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",style:{color:"#06b6d4"},children:"DRIVE 917"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"Luxury Vehicle Rental Services"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Bill To:"}),(0,a.jsxs)("div",{className:"text-sm space-y-1",children:[(0,a.jsx)("p",{className:"font-medium",children:r.name}),r.email&&(0,a.jsx)("p",{children:r.email}),r.phone&&(0,a.jsx)("p",{children:r.phone})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Invoice Details:"}),(0,a.jsxs)("div",{className:"text-sm space-y-1",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Invoice #:"})," ",(0,a.jsx)("strong",{children:s.invoice_number})]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Date:"})," ",(0,ed.GP)(new Date(s.invoice_date),"PPP")]}),s.due_date&&(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Due Date:"})," ",(0,ed.GP)(new Date(s.due_date),"PPP")]})]})]})]}),(0,a.jsxs)("div",{className:"border border-gray-300 rounded-lg p-4 bg-gray-50 mb-6",children:[(0,a.jsx)("h3",{className:"font-semibold mb-3",children:"Rental Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Vehicle:"}),(0,a.jsx)("p",{className:"font-medium",children:n}),(0,a.jsxs)("p",{className:"text-gray-500 text-xs",children:["Reg: ",l.reg]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Rental Period:"}),(0,a.jsxs)("p",{className:"font-medium",children:[(0,ed.GP)(new Date(i.start_date),"PP")," - ",(0,ed.GP)(new Date(i.end_date),"PP")]})]})]})]}),(0,a.jsx)("div",{className:"border border-gray-300 rounded-lg overflow-hidden mb-6",children:(0,a.jsxs)("table",{className:"w-full border-collapse",children:[(0,a.jsx)("thead",{className:"bg-gray-100",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left p-3 text-sm font-semibold border-b border-gray-300",children:"Description"}),(0,a.jsx)("th",{className:"text-right p-3 text-sm font-semibold border-b border-gray-300",children:"Amount"})]})}),(0,a.jsxs)("tbody",{children:[(0,a.jsxs)("tr",{className:"border-b border-gray-300",children:[(0,a.jsx)("td",{className:"p-3 text-sm",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Rental Fee"}),(0,a.jsxs)("p",{className:"text-xs text-gray-600",children:[n," (",l.reg,")"]})]})}),(0,a.jsx)("td",{className:"p-3 text-sm text-right font-medium",children:eP(c)})]}),o&&(0,a.jsxs)("tr",{className:"border-b border-gray-300",children:[(0,a.jsx)("td",{className:"p-3 text-sm",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("span",{style:{color:"#C5A572"},children:"\uD83D\uDEE1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Protection Plan"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:o.name})]})]})}),(0,a.jsx)("td",{className:"p-3 text-sm text-right font-medium",style:{color:"#C5A572"},children:eP(o.cost)})]}),s.tax_amount>0&&(0,a.jsxs)("tr",{className:"border-b border-gray-300",children:[(0,a.jsx)("td",{className:"p-3 text-sm",children:"Taxes & Fees"}),(0,a.jsx)("td",{className:"p-3 text-sm text-right",children:eP(s.tax_amount)})]}),(0,a.jsxs)("tr",{className:"bg-gray-100",children:[(0,a.jsx)("td",{className:"p-3 text-sm font-bold",children:"Total"}),(0,a.jsx)("td",{className:"p-3 text-lg font-bold text-right",style:{color:"#06b6d4"},children:eP(s.total_amount)})]})]})]})}),s.notes&&(0,a.jsxs)("div",{className:"border border-gray-300 rounded-lg p-4 bg-gray-50 mb-6",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2 text-sm",children:"Notes:"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:s.notes})]}),(0,a.jsxs)("div",{className:"text-center text-sm text-gray-600 border-t border-gray-300 pt-4",children:[(0,a.jsx)("p",{children:"Thank you for your business!"}),(0,a.jsx)("p",{className:"text-xs mt-1",children:"This is a computer-generated invoice."})]})]})},eD=e=>{var t;let{open:s,onOpenChange:r,invoice:l,customer:i,vehicle:o,rental:n,protectionPlan:c}=e,d=(0,P.useRef)(null),m=o.make&&o.model?"".concat(o.make," ").concat(o.model):o.reg,u=null!=(t=null==c?void 0:c.rentalFee)?t:l.subtotal,p=(0,e_.useReactToPrint)({contentRef:d,documentTitle:"Invoice-".concat(l.invoice_number),pageStyle:"\n      @page {\n        size: A4;\n        margin: 0.5in;\n      }\n      @media print {\n        body {\n          -webkit-print-color-adjust: exact;\n          print-color-adjust: exact;\n        }\n      }\n    "});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:{display:"none"},children:(0,a.jsx)("div",{ref:d,children:(0,a.jsx)(eS,{invoice:l,customer:i,vehicle:o,rental:n,protectionPlan:c})})}),(0,a.jsx)(ex.lG,{open:s,onOpenChange:r,children:(0,a.jsxs)(ex.Cf,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(ex.c7,{children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)(ex.L3,{className:"flex items-center gap-2",children:[(0,a.jsx)(eN.A,{className:"h-5 w-5 text-accent"}),"Invoice"]})})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"border-b pb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-accent",children:"DRIVE 917"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Luxury Vehicle Rental Services"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Bill To:"}),(0,a.jsxs)("div",{className:"text-sm space-y-1",children:[(0,a.jsx)("p",{className:"font-medium",children:i.name}),i.email&&(0,a.jsx)("p",{children:i.email}),i.phone&&(0,a.jsx)("p",{children:i.phone})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Invoice Details:"}),(0,a.jsxs)("div",{className:"text-sm space-y-1",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Invoice #:"})," ",(0,a.jsx)("strong",{children:l.invoice_number})]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Date:"})," ",(0,ed.GP)(new Date(l.invoice_date),"PPP")]}),l.due_date&&(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Due Date:"})," ",(0,ed.GP)(new Date(l.due_date),"PPP")]})]})]})]}),(0,a.jsxs)("div",{className:"border rounded-lg p-4 bg-muted/30",children:[(0,a.jsx)("h3",{className:"font-semibold mb-3",children:"Rental Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-muted-foreground",children:"Vehicle:"}),(0,a.jsx)("p",{className:"font-medium",children:m}),(0,a.jsxs)("p",{className:"text-muted-foreground text-xs",children:["Reg: ",o.reg]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-muted-foreground",children:"Rental Period:"}),(0,a.jsxs)("p",{className:"font-medium",children:[(0,ed.GP)(new Date(n.start_date),"PP")," - ",(0,ed.GP)(new Date(n.end_date),"PP")]})]})]})]}),(0,a.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-muted",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"text-left p-3 text-sm font-semibold",children:"Description"}),(0,a.jsx)("th",{className:"text-right p-3 text-sm font-semibold",children:"Amount"})]})}),(0,a.jsxs)("tbody",{children:[(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("td",{className:"p-3 text-sm",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Rental Fee"}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[m," (",o.reg,")"]})]})}),(0,a.jsx)("td",{className:"p-3 text-sm text-right font-medium",children:eP(u)})]}),c&&(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("td",{className:"p-3 text-sm",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(x.A,{className:"w-4 h-4 text-primary mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"Protection Plan"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:c.name})]})]})}),(0,a.jsx)("td",{className:"p-3 text-sm text-right font-medium text-primary",children:eP(c.cost)})]}),l.tax_amount>0&&(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("td",{className:"p-3 text-sm",children:"Taxes & Fees"}),(0,a.jsx)("td",{className:"p-3 text-sm text-right",children:eP(l.tax_amount)})]}),(0,a.jsxs)("tr",{className:"bg-muted/50",children:[(0,a.jsx)("td",{className:"p-3 text-sm font-bold",children:"Total"}),(0,a.jsx)("td",{className:"p-3 text-lg font-bold text-right text-accent",children:eP(l.total_amount)})]})]})]})}),l.notes&&(0,a.jsxs)("div",{className:"border rounded-lg p-4 bg-muted/30",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2 text-sm",children:"Notes:"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:l.notes})]}),(0,a.jsxs)("div",{className:"text-center text-sm text-muted-foreground border-t pt-4",children:[(0,a.jsx)("p",{children:"Thank you for your business!"}),(0,a.jsx)("p",{className:"text-xs mt-1",children:"This is a computer-generated invoice."})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center border-t pt-4",children:[(0,a.jsxs)(L.$,{variant:"outline",onClick:p,children:[(0,a.jsx)(ew.A,{className:"h-4 w-4 mr-2"}),"Print / Save PDF"]}),(0,a.jsxs)(L.$,{onClick:()=>r(!1),className:"gradient-accent",children:["Continue to Sign Agreement",(0,a.jsx)(ek.A,{className:"h-4 w-4 ml-2"})]})]})]})})]})},eC=()=>{let e=new Date,t=(0,ed.GP)(e,"yyyy"),s=(0,ed.GP)(e,"MM"),a=(0,ed.GP)(e,"dd"),r=Math.random().toString(36).substring(2,6).toUpperCase();return"INV-".concat(t).concat(s).concat(a,"-").concat(r)},eA=async e=>{let t=eC();console.log("\uD83D\uDCC4 Creating invoice with data:",{rental_id:e.rental_id,customer_id:e.customer_id,vehicle_id:e.vehicle_id,invoice_number:t,total_amount:e.total_amount});let{data:s,error:a}=await S.N.from("invoices").insert({rental_id:e.rental_id,customer_id:e.customer_id,vehicle_id:e.vehicle_id,invoice_number:t,invoice_date:(0,ed.GP)(e.invoice_date,"yyyy-MM-dd"),due_date:e.due_date?(0,ed.GP)(e.due_date,"yyyy-MM-dd"):null,subtotal:e.subtotal,rental_fee:e.rental_fee||e.subtotal,protection_fee:e.protection_fee||0,tax_amount:e.tax_amount||0,total_amount:e.total_amount,status:"pending",notes:e.notes}).select().single();if(a)throw console.error("❌ Error creating invoice in database:",a),a;return console.log("✅ Invoice created:",s.invoice_number),s},eL=async e=>{try{return await eA(e)}catch(t){return console.warn("⚠️ Database invoice creation failed, using local invoice:",t),(e=>{let t=eC(),s=new Date().toISOString();return{id:crypto.randomUUID(),rental_id:e.rental_id,customer_id:e.customer_id,vehicle_id:e.vehicle_id,invoice_number:t,invoice_date:(0,ed.GP)(e.invoice_date,"yyyy-MM-dd"),due_date:e.due_date?(0,ed.GP)(e.due_date,"yyyy-MM-dd"):void 0,subtotal:e.subtotal,rental_fee:e.rental_fee||e.subtotal,protection_fee:e.protection_fee||0,tax_amount:e.tax_amount||0,total_amount:e.total_amount,status:"pending",notes:e.notes,created_at:s}})(e)}};function eR(e){let{formData:t,selectedVehicle:s,extras:r,rentalDuration:l,vehicleTotal:i,selectedProtectionPlan:o,onBack:n}=e;(0,ef.useRouter)();let[d,m]=(0,P.useState)(!1),[u,g]=(0,P.useState)(!1),[f,v]=(0,P.useState)(!1),[j,b]=(0,P.useState)(null),[y,N]=(0,P.useState)(null),[k,_]=(0,P.useState)(!1),D=()=>{if(!o)return 0;let e=l.days;if(e>=30&&o.price_per_month){let t=Math.ceil(e/30);return o.price_per_month*t}if(!(e>=7)||!o.price_per_week)return o.price_per_day*e;{let t=Math.ceil(e/7);return o.price_per_week*t}},C=()=>{let e=.1*i+50;return i+e+D()},A=async()=>{try{let{data:e,error:t}=await S.N.functions.invoke("get-booking-mode");if(t)return console.error("Error fetching booking mode:",t),"manual";return(null==e?void 0:e.mode)||"manual"}catch(e){return console.error("Error fetching booking mode:",e),"manual"}},R=async()=>{if(!y)return void H.oR.error("Rental data not found");try{g(!0);let{data:e,error:s}=await S.N.functions.invoke("create-checkout-session",{body:{rentalId:y.rental.id,customerEmail:t.customerEmail,customerName:t.customerName,totalAmount:C()}});if(s)throw s;if(null==e?void 0:e.url)window.gtag&&window.gtag("event","redirecting_to_stripe",{rental_id:y.rental.id,customer_id:y.customer.id,total:C()}),window.location.href=e.url;else throw Error("Failed to create checkout session")}catch(e){console.error("Stripe redirect error:",e),H.oR.error(e.message||"Failed to redirect to payment"),g(!1)}},I=async()=>{if(!y)return void H.oR.error("Rental data not found");try{g(!0);let{data:e,error:a}=await S.N.functions.invoke("create-preauth-checkout",{body:{rentalId:y.rental.id,customerId:y.customer.id,customerEmail:t.customerEmail,customerName:t.customerName,customerPhone:t.customerPhone,vehicleId:s.id,vehicleName:s.make&&s.model?"".concat(s.make," ").concat(s.model):s.reg,totalAmount:C(),pickupDate:t.pickupDate,returnDate:t.dropoffDate,protectionPlan:(null==o?void 0:o.display_name)||"none"}});if(a)throw a;if(null==e?void 0:e.url)window.gtag&&window.gtag("event","redirecting_to_stripe_preauth",{rental_id:y.rental.id,customer_id:y.customer.id,total:C()}),window.location.href=e.url;else throw Error("Failed to create checkout session")}catch(e){console.error("Stripe pre-auth redirect error:",e),H.oR.error(e.message||"Failed to redirect to payment"),g(!1)}},E=async()=>{if(y)try{_(!0),H.oR.loading("Sending rental agreement via DocuSign...",{id:"docusign-send"});let{data:e,error:s}=await S.N.functions.invoke("create-docusign-envelope",{body:{rentalId:y.rental.id,customerId:y.customer.id,customerEmail:t.customerEmail,customerName:t.customerName}});if(s)throw s;if(null==e?void 0:e.ok)H.oR.success("Rental agreement sent successfully!",{id:"docusign-send"});else throw Error((null==e?void 0:e.error)||"Failed to send DocuSign")}catch(e){console.error("DocuSign error:",e),H.oR.error(e.message||"Failed to send rental agreement",{id:"docusign-send"})}finally{_(!1),"manual"===await A()?I():R()}},M=async()=>{if(!d)return void H.oR.error("You must agree to the terms and conditions");if(!u){window.gtag&&window.gtag("event","checkout_submitted",{vehicle_id:s.id,total:C()}),g(!0),console.log("\uD83D\uDD0D Checkout formData:",t),console.log("\uD83D\uDD0D Verification Session ID:",t.verificationSessionId);try{let e;console.log("\uD83D\uDCDD Finding or creating customer...");let{data:a}=await S.N.from("customers").select("*").eq("email",t.customerEmail).maybeSingle();if(a){console.log("\uD83D\uDC64 Found existing customer, updating...");let{data:s,error:r}=await S.N.from("customers").update({type:t.customerType,name:t.customerName,phone:t.customerPhone,status:"Active"}).eq("id",a.id).select().single();if(r)throw r;e=s}else{console.log("\uD83C\uDD95 Creating new customer...");let{data:s,error:a}=await S.N.from("customers").insert({type:t.customerType,name:t.customerName,email:t.customerEmail,phone:t.customerPhone,status:"Active",is_blocked:!1}).select().single();if(a)throw a;e=s}if(console.log("✅ Customer ready:",e.id),t.verificationSessionId){console.log("\uD83D\uDD17 Linking verification to customer:",t.verificationSessionId),console.log("\uD83D\uDD17 Customer ID to link:",e.id);let{data:s,error:a}=await S.N.from("identity_verifications").select("*").eq("session_id",t.verificationSessionId).maybeSingle();if(console.log("\uD83D\uDD0D Query result - verification:",s),console.log("\uD83D\uDD0D Query result - error:",a),!a&&s){console.log("✅ Found verification record:",{id:s.id,session_id:s.session_id,current_customer_id:s.customer_id,review_result:s.review_result});let{data:t,error:a}=await S.N.from("identity_verifications").update({customer_id:e.id}).eq("id",s.id).select();if(console.log("\uD83D\uDCDD Update result - data:",t),console.log("\uD83D\uDCDD Update result - error:",a),a)console.error("❌ Failed to link verification to customer:",a);else{console.log("✅ Successfully linked verification to customer"),console.log("✅ Updated verification record:",t);let{data:a}=await S.N.from("identity_verifications").select("id, session_id, customer_id, review_result").eq("id",s.id).single();console.log("\uD83D\uDD0D Verification after update:",a);let r="pending";"GREEN"===s.review_result?r="verified":"RED"===s.review_result&&(r="rejected");let{error:l}=await S.N.from("customers").update({identity_verification_status:r}).eq("id",e.id);l?console.error("Failed to update customer verification status:",l):console.log("✅ Updated customer verification status to:",r)}}else console.log("❌ Verification not found or still pending"),console.log("Error details:",a)}else console.log("⚠️ No verification session ID in formData");let r=(()=>{let e=l.days;return e>=30?"Monthly":e>=7?"Weekly":"Daily"})(),n=C(),{data:c,error:d}=await S.N.from("rentals").insert({customer_id:e.id,vehicle_id:s.id,start_date:t.pickupDate,end_date:t.dropoffDate,rental_period_type:r,monthly_amount:n,status:"Pending"}).select().single();if(d)throw d;console.log("\uD83D\uDD04 Generating first charge for rental:",c.id);let{error:m}=await S.N.rpc("generate_first_charge_for_rental",{rental_id_param:c.id});m?console.error("⚠️ Failed to generate first charge:",m):console.log("✅ First charge generated successfully");let u=await A();if(console.log("\uD83D\uDCCB Booking mode:",u),"auto"===u){let{error:e}=await S.N.from("vehicles").update({status:"Rented"}).eq("id",s.id);e?console.error("Failed to update vehicle status:",e):console.log("✅ Vehicle marked as Rented (AUTO mode)")}else console.log("⏳ Vehicle status unchanged (MANUAL mode - awaiting approval)");if(console.log("\uD83D\uDEE1️ Protection Plan Debug:",{hasSelectedPlan:!!o,planId:t.protectionPlanId,planDetails:o?{display_name:o.display_name,price_per_day:o.price_per_day}:null,rentalId:c.id,rentalDays:l.days}),o&&t.protectionPlanId)try{let e=D(),s={rental_id:c.id,protection_plan_id:t.protectionPlanId,daily_rate:o.price_per_day,total_days:l.days,total_cost:e};console.log("\uD83D\uDEE1️ Inserting protection selection:",s);let{data:a,error:r}=await S.N.from("rental_protection_selections").insert(s).select();r?(console.error("❌ Failed to save protection plan selection:",r),console.error("❌ Error details:",JSON.stringify(r,null,2))):(console.log("✅ Protection plan selection saved successfully!"),console.log("✅ Saved data:",a))}catch(e){console.error("❌ Protection plan save error (catch):",e)}else console.log("⚠️ Skipping protection plan save - no plan selected or missing planId");let x=D(),p="Security deposit of $".concat(500..toLocaleString()," will be held during the rental period.");o&&(p+="\n\nProtection Plan: ".concat(o.display_name," - $").concat(x.toLocaleString()," (").concat(l.days," days @ $").concat(o.price_per_day,"/day)"),0===o.deductible_amount?p+="\n✓ Zero Deductible Coverage":p+="\n• Deductible: $".concat(o.deductible_amount.toLocaleString()),o.max_coverage_amount&&(p+="\n• Maximum Coverage: $".concat(o.max_coverage_amount.toLocaleString())));let h=await eL({rental_id:c.id,customer_id:e.id,vehicle_id:s.id,invoice_date:new Date,due_date:new Date(t.pickupDate),subtotal:i+x,rental_fee:i,protection_fee:x,tax_amount:.1*i+50,total_amount:C(),notes:p});console.log("✅ Invoice ready:",h.invoice_number),b(h),console.log("\uD83D\uDCB3 Storing payment details for success page...");let f={amount:C(),customer_id:e.id,rental_id:c.id,vehicle_id:s.id,apply_from_date:t.pickupDate};localStorage.setItem("pendingPaymentDetails",JSON.stringify(f)),console.log("✅ Payment details stored:",f),N({customer:e,rental:c,vehicle:s}),v(!0),g(!1)}catch(e){console.error("Payment error:",e),H.oR.error(e.message||"Failed to initiate payment"),window.gtag&&window.gtag("event","payment_failed",{error:e.message})}finally{g(!1)}}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-3xl font-display font-bold text-gradient-metal mb-2",children:"Review & Payment"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Confirm your details and secure your rental below."})]}),(0,a.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)(w.Zp,{className:"p-6 bg-card border-accent/20",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Rental Summary"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(p.A,{className:"w-5 h-5 text-accent mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:s.make&&s.model?"".concat(s.make," ").concat(s.model):s.reg}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[s.colour?"".concat(s.colour," • "):"",s.reg]})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(X.A,{className:"w-5 h-5 text-accent mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:l.formatted}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,ed.GP)(new Date(t.pickupDate),"MMM dd, yyyy")," - ",(0,ed.GP)(new Date(t.dropoffDate),"MMM dd, yyyy")]})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(c.A,{className:"w-5 h-5 text-accent mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium",children:["Pickup: ",t.pickupLocation]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Return: ",t.dropoffLocation]})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(h.A,{className:"w-5 h-5 text-accent mt-0.5"}),(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Pickup: ",t.pickupTime," | Return: ",t.dropoffTime]})})]}),o&&(0,a.jsxs)("div",{className:"flex items-start gap-3 pt-3 border-t border-border/50",children:[(0,a.jsx)(x.A,{className:"w-5 h-5 text-primary mt-0.5"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-medium text-primary",children:o.display_name}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:o.description}),(0,a.jsxs)("div",{className:"mt-2 space-y-1",children:[0===o.deductible_amount&&(0,a.jsx)("p",{className:"text-xs text-green-600 font-medium",children:"✓ Zero Deductible"}),o.max_coverage_amount&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Coverage up to $",o.max_coverage_amount.toLocaleString()]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-semibold text-primary",children:["$",D().toLocaleString()]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["$",o.price_per_day,"/day"]})]})]})]})]}),(0,a.jsxs)(w.Zp,{className:"p-6 bg-card border-accent/20",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Your Details"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(ej.A,{className:"w-5 h-5 text-accent mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:t.customerName}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:t.customerType})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"w-5 h-5 text-accent mt-0.5 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-sm",children:"@"})}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm",children:t.customerEmail})})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"w-5 h-5 text-accent mt-0.5 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-sm",children:"\uD83D\uDCDE"})}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm",children:t.customerPhone})})]})]})]}),(0,a.jsx)(w.Zp,{className:"p-6 cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>m(!d),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(ev.S,{checked:d,onCheckedChange:e=>m(e),className:"mt-0.5",onClick:e=>e.stopPropagation()}),(0,a.jsxs)(z.J,{className:"text-sm leading-relaxed cursor-pointer",children:["By confirming, you agree to Drive 917's"," ",(0,a.jsx)("a",{href:"/terms",target:"_blank",className:"text-accent underline",onClick:e=>e.stopPropagation(),children:"Terms of Service"})," and"," ",(0,a.jsx)("a",{href:"/privacy",target:"_blank",className:"text-accent underline",onClick:e=>e.stopPropagation(),children:"Privacy Policy"}),"."]})]})})]}),(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)(w.Zp,{className:"p-6 bg-gradient-dark border-accent/30 lg:sticky lg:top-24",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gradient-metal mb-4",children:"Price Summary"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsxs)("span",{className:"text-muted-foreground",children:["Rental (",l.days," days)"]}),(0,a.jsxs)("span",{className:"font-medium",children:["$",i.toLocaleString()]})]}),o&&(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x.A,{className:"w-4 h-4 text-primary"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:o.display_name})]}),(0,a.jsxs)("span",{className:"font-medium text-primary",children:["+$",D().toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Taxes & Fees"}),(0,a.jsxs)("span",{className:"font-medium",children:["$",(.1*i+50).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm pb-3 border-b border-border",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Security Deposit (hold)"}),(0,a.jsxs)("span",{className:"font-medium",children:["$",500..toLocaleString()]})]}),(0,a.jsx)("div",{className:"pt-3 border-t border-accent/30",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-lg font-semibold",children:"Total Due Today"}),(0,a.jsxs)("span",{className:"text-2xl font-bold text-accent",children:["$",C().toLocaleString()]})]})}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-4",children:"You'll receive a digital receipt immediately. Deposit is held, not charged."})]}),(0,a.jsxs)("div",{className:"mt-6 space-y-3",children:[(0,a.jsx)(L.$,{onClick:M,disabled:u||k||!d,className:"w-full gradient-accent hover-lift",size:"lg",children:u?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eb.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):k?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eb.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Sending Agreement..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ey.A,{className:"w-4 h-4 mr-2"}),"Confirm & Pay $",C().toLocaleString()]})}),(0,a.jsxs)(L.$,{onClick:n,variant:"outline",className:"w-full border-primary text-primary hover:bg-primary/10",size:"lg",disabled:u,children:[(0,a.jsx)(et.A,{className:"w-4 h-4 mr-2"}),"Back to Vehicles"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground justify-center pt-2",children:[(0,a.jsx)(x.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Secured by Stripe. Card details never stored."})]})]})]})})]}),j&&y&&(0,a.jsx)(eD,{open:f,onOpenChange:e=>{v(e),e||E()},invoice:j,customer:{name:t.customerName,email:t.customerEmail,phone:t.customerPhone},vehicle:{reg:s.reg,make:s.make,model:s.model},rental:{start_date:t.pickupDate,end_date:t.dropoffDate,monthly_amount:y.rental.monthly_amount},protectionPlan:o?{name:o.display_name,cost:D(),rentalFee:i}:void 0})]})}var eI=s(6907),eE=s(3327),eM=s(2108),eT=s(4033),e$=s(7259);let eF=e$.bL,ez=e$.R6,eV=e$.Ke,eq=e=>{let{tier:t,className:s}=e;switch(t){case"basic":default:return(0,a.jsx)(x.A,{className:s});case"standard":return(0,a.jsx)(eI.A,{className:s});case"premium":case"ultimate":return(0,a.jsx)(N.A,{className:s})}},eG=e=>{let{selectedPlanId:t,onSelectPlan:s,rentalDays:r}=e,[l,i]=(0,P.useState)([]),[o,n]=(0,P.useState)(!0),[c,d]=(0,P.useState)(null);(0,P.useEffect)(()=>{m()},[]);let m=async()=>{try{let{data:e,error:t}=await S.N.from("protection_plans").select("*").eq("is_active",!0).order("display_order",{ascending:!0});if(t)throw t;i(e||[])}catch(e){console.error("Error loading protection plans:",e)}finally{n(!1)}},u=e=>{if(r>=30&&e.price_per_month){let t=Math.ceil(r/30);return{total:e.price_per_month*t,perDay:e.price_per_month/30,label:"$".concat(e.price_per_month,"/month")}}if(!(r>=7)||!e.price_per_week)return{total:e.price_per_day*r,perDay:e.price_per_day,label:"$".concat(e.price_per_day,"/day")};{let t=Math.ceil(r/7);return{total:e.price_per_week*t,perDay:e.price_per_week/7,label:"$".concat(e.price_per_week,"/week")}}};return o?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"h-48 bg-muted animate-pulse rounded-lg"}),(0,a.jsx)("div",{className:"h-48 bg-muted animate-pulse rounded-lg"}),(0,a.jsx)("div",{className:"h-48 bg-muted animate-pulse rounded-lg"})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center max-w-2xl mx-auto",children:[(0,a.jsx)("h3",{className:"text-2xl md:text-3xl font-display font-semibold mb-2",children:"Protect Your Rental"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Add comprehensive protection coverage and save up to 50% compared to rental counter prices"})]}),(0,a.jsx)(w.Zp,{className:(0,G.cn)("cursor-pointer transition-all duration-300 border-2",null===t?"border-primary bg-primary/5":"border-border hover:border-primary/40"),onClick:()=>s(null,null),children:(0,a.jsx)("div",{className:"p-4 sm:p-6",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4",children:[(0,a.jsx)("div",{className:(0,G.cn)("w-10 h-10 sm:w-12 sm:h-12 rounded-lg flex items-center justify-center flex-shrink-0",null===t?"bg-primary/20":"bg-muted"),children:(0,a.jsx)(eE.A,{className:(0,G.cn)("w-5 h-5 sm:w-6 sm:h-6",null===t?"text-primary":"text-muted-foreground")})}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("h4",{className:"font-semibold text-base sm:text-lg",children:"Decline Protection"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"I'll use my own insurance or accept the risk"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between sm:justify-end gap-3 sm:gap-4 pt-2 sm:pt-0 border-t sm:border-0 border-border/50",children:[(0,a.jsxs)("div",{className:"sm:text-right",children:[(0,a.jsx)("div",{className:"text-xl sm:text-2xl font-bold",children:"$0"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"No additional cost"})]}),null===t&&(0,a.jsx)("div",{className:"w-6 h-6 bg-primary rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(K.A,{className:"w-4 h-4 text-primary-foreground"})})]})]})})}),l.map(e=>{let l=u(e),i=(e=>{let t=u(e).total,s=2.5*t,a=s-t,r=Math.round(a/s*100);return{amount:a,percent:r}})(e),o=t===e.id,n=c===e.id,m="premium"===e.tier||"ultimate"===e.tier;return(0,a.jsxs)(w.Zp,{className:(0,G.cn)("cursor-pointer transition-all duration-300 border-2 relative overflow-hidden",o?"border-primary bg-primary/5 shadow-glow":"border-border hover:border-primary/40",m&&"shadow-glow"),onClick:()=>s(e.id,e),children:["standard"===e.tier&&(0,a.jsx)("div",{className:"flex justify-end mt-2 mr-3",children:(0,a.jsx)(W.E,{className:"bg-green-600 text-white",children:"Recommended"})}),m&&(0,a.jsx)("div",{className:"flex justify-end mt-2 mr-3",children:(0,a.jsx)(W.E,{className:"bg-primary text-primary-foreground",children:"Best Value"})}),m&&(0,a.jsx)("div",{className:" inset-0 opacity-5 pointer-events-none",style:{background:"linear-gradient(135deg, ".concat(e.color_theme,"40 0%, transparent 100%)")}}),(0,a.jsxs)("div",{className:"p-4 md:p-6 space-y-4 relative",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 sm:gap-4 flex-1",children:[(0,a.jsx)("div",{className:"w-12 h-12 sm:w-16 sm:h-16 rounded-xl flex items-center justify-center flex-shrink-0",style:{backgroundColor:(e.color_theme||"#60A5FA")+"20"},children:(0,a.jsx)(eq,{tier:e.tier,className:"w-6 h-6 sm:w-8 sm:h-8",style:{color:e.color_theme||"#60A5FA"}})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h4",{className:"font-display text-lg sm:text-xl font-semibold mb-1",children:e.display_name}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground mb-2 sm:mb-3 line-clamp-2 sm:line-clamp-none",children:e.description}),0===e.deductible_amount?(0,a.jsx)(W.E,{variant:"default",className:"bg-green-600 text-xs",children:"ZERO DEDUCTIBLE"}):(0,a.jsxs)(W.E,{variant:"secondary",className:"text-xs",children:["$",e.deductible_amount.toLocaleString()," Deductible"]})]})]}),(0,a.jsxs)("div",{className:"flex sm:flex-col items-center sm:items-end justify-between sm:justify-start gap-2 sm:gap-0 pt-2 sm:pt-0 border-t sm:border-0 border-border/50",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:items-end",children:[(0,a.jsxs)("div",{className:"text-2xl sm:text-3xl font-bold",style:{color:e.color_theme||"#60A5FA"},children:["$",l.total.toLocaleString()]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[l.label," \xd7 ",r," days"]}),(0,a.jsxs)("div",{className:"text-xs font-medium text-green-600 mt-1",children:["Save ",i.percent,"% vs rental counter"]})]}),o&&(0,a.jsx)("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center sm:mt-3",children:(0,a.jsx)(K.A,{className:"w-5 h-5 text-primary-foreground"})})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:e.features.slice(0,4).map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start gap-2 text-xs sm:text-sm",children:[(0,a.jsx)(K.A,{className:"w-4 h-4 text-green-600 flex-shrink-0 mt-0.5"}),(0,a.jsx)("span",{children:e})]},t))}),(e.features.length>4||e.exclusions.length>0)&&(0,a.jsxs)(eF,{open:n,onOpenChange:()=>d(n?null:e.id),children:[(0,a.jsx)(ez,{asChild:!0,children:(0,a.jsx)(L.$,{variant:"ghost",size:"sm",className:"w-full",onClick:t=>{t.stopPropagation(),d(n?null:e.id)},children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eM.A,{className:"w-4 h-4 mr-2"}),"Show Less"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eT.A,{className:"w-4 h-4 mr-2"}),"View Full Coverage Details"]})})}),(0,a.jsxs)(eV,{className:"space-y-4 pt-4",children:[e.features.length>4&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"font-semibold text-sm mb-2",children:"All Features:"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:e.features.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start gap-2 text-sm",children:[(0,a.jsx)(K.A,{className:"w-4 h-4 text-green-600 flex-shrink-0 mt-0.5"}),(0,a.jsx)("span",{children:e})]},t))})]}),e.exclusions.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"font-semibold text-sm mb-2 text-destructive",children:"Not Covered:"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:e.exclusions.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[(0,a.jsx)("span",{className:"text-destructive",children:"\xd7"}),(0,a.jsx)("span",{children:e})]},t))})]}),e.max_coverage_amount&&(0,a.jsx)("div",{className:"pt-3 border-t border-border",children:(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Maximum Coverage:"}),(0,a.jsxs)("span",{className:"font-semibold",children:["$",e.max_coverage_amount.toLocaleString()]})]})})]})]}),!o&&(0,a.jsxs)(L.$,{className:(0,G.cn)("w-full mt-4",m?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-background border-2 border-primary text-primary hover:bg-primary hover:text-primary-foreground"),onClick:t=>{t.stopPropagation(),s(e.id,e)},children:["Select ",e.display_name]})]})]},e.id)})]})},eO=()=>{var e,t,s,r,l,i,o,c;let[d,m]=(0,P.useState)(1),[u,g]=(0,P.useState)([]),[f,v]=(0,P.useState)([]),[b,y]=(0,P.useState)([]),[_,D]=(0,P.useState)(!1),[C,A]=(0,P.useState)(!1),[R,I]=(0,P.useState)(""),[E,M]=(0,P.useState)(null),[T,$]=(0,P.useState)(null),[q,Y]=(0,P.useState)(!1),[ex,ep]=(0,P.useState)(!1),[ef,ev]=(0,P.useState)(!1),[ej,eb]=(0,P.useState)(null),ey=(0,P.useRef)(!1),eN=(0,P.useRef)(null),ew=(0,P.useRef)(null),[ek,e_]=(0,P.useState)([]),[eP,eS]=(0,P.useState)([]),[eD,eC]=(0,P.useState)({}),[eA,eL]=(0,P.useState)(!0),{data:eI}=(0,k.y)("home"),eE=(0,k.TP)(eI,k.Sz),[eM,eT]=(0,P.useState)(""),[e$,eF]=(0,P.useState)("grid"),[ez,eV]=(0,P.useState)("recommended"),[eq,eO]=(0,P.useState)([]),[eZ,eB]=(0,P.useState)(!1),[eJ,eY]=(0,P.useState)([0,500]),[eU,eW]=(0,P.useState)([0,2e3]),[eH,eQ]=(0,P.useState)([0,5e3]),[eK,eX]=(0,P.useState)({transmission:[],fuel:[],seats:[2,7],dailyPriceRange:[0,500],weeklyPriceRange:[0,2e3],monthlyPriceRange:[0,5e3],colors:[]}),e0=(0,P.useRef)(),[e2,e1]=(0,P.useState)(new Set),[e5,e3]=(0,P.useState)({pickupLocation:"",dropoffLocation:"",pickupDate:"",dropoffDate:"",pickupTime:"",dropoffTime:"",specialRequests:"",vehicleId:"",driverAge:"",promoCode:"",customerName:"",customerEmail:"",customerPhone:"",customerType:"",licenseNumber:"",verificationSessionId:"",protectionPlanId:null}),[e4,e6]=(0,P.useState)(null),[e8,e7]=(0,P.useState)(null),[e9,te]=(0,P.useState)("init"),[tt,ts]=(0,P.useState)(!1),[ta,tr]=(0,P.useState)({pickupLat:null,pickupLon:null,dropoffLat:null,dropoffLon:null});(0,P.useEffect)(()=>{tl();let e=localStorage.getItem("viewMode");("grid"===e||"list"===e)&&eF(e);let t=localStorage.getItem("verificationSessionId"),s=localStorage.getItem("verificationStatus");localStorage.getItem("verificationToken"),t&&s&&(e7(t),te(s),e3(e=>({...e,verificationSessionId:t})),console.log("✅ Loaded verification from localStorage:",t,s));let a=async()=>{let e=localStorage.getItem("verificationSessionId"),t=localStorage.getItem("verificationStatus");if(e&&"pending"===t){console.log("\uD83D\uDD04 Window focused - checking verification status for iOS Safari...");let t=await ti(e);t&&("GREEN"===t.review_result?(te("verified"),localStorage.setItem("verificationStatus","verified"),H.oR.success("Identity verification successful!"),console.log("✅ Verification updated on window focus")):"RED"===t.review_result&&(te("rejected"),localStorage.setItem("verificationStatus","rejected"),H.oR.error("Identity verification failed.")))}},r=()=>{"visible"===document.visibilityState&&a()},l=async e=>{var t;if(e.origin===window.location.origin&&(null==(t=e.data)?void 0:t.type)==="VERIFF_COMPLETE"){console.log("\uD83D\uDCE8 Received VERIFF_COMPLETE message from popup");let e=localStorage.getItem("verificationSessionId");if(e){let t=async function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;console.log("\uD83D\uDD04 Checking verification status (attempt ".concat(s,"/").concat(a,")..."));let r=await ti(e);return(null==r?void 0:r.review_result)==="GREEN"?(te("verified"),localStorage.setItem("verificationStatus","verified"),H.oR.success("Identity verification successful!"),console.log("✅ Verification confirmed via popup message"),!0):(null==r?void 0:r.review_result)==="RED"?(te("rejected"),localStorage.setItem("verificationStatus","rejected"),H.oR.error("Identity verification failed."),!0):void(s<a?setTimeout(()=>t(s+1,a),2e3*s):console.log("⚠️ Max retry attempts reached, webhook may be delayed"))};setTimeout(()=>t(),2e3)}}};return window.addEventListener("focus",a),document.addEventListener("visibilitychange",r),window.addEventListener("message",l),()=>{window.removeEventListener("focus",a),document.removeEventListener("visibilitychange",r),window.removeEventListener("message",l)}},[]),(0,P.useEffect)(()=>{eA&&e5.pickupLocation&&(e3(e=>({...e,dropoffLocation:e.pickupLocation})),ta.pickupLat&&ta.pickupLon&&tr(e=>({...e,dropoffLat:e.pickupLat,dropoffLon:e.pickupLon})))},[eA,e5.pickupLocation,ta.pickupLat,ta.pickupLon]),(0,P.useEffect)(()=>{e5.vehicleId&&eN.current&&2===d&&setTimeout(()=>{let e=eN.current;if(e){let t=e.getBoundingClientRect().top+window.scrollY;window.scrollTo({top:t-250,behavior:"smooth"})}},300)},[e5.vehicleId,d]),(0,P.useEffect)(()=>{if(ew.current){let e=ew.current.getBoundingClientRect().top+window.scrollY;window.scrollTo({top:e-100,behavior:"smooth"})}},[d]),(0,P.useEffect)(()=>{let{pickupLat:e,pickupLon:t,dropoffLat:s,dropoffLon:a}=ta;e&&t&&s&&a&&tc()},[ta]),(0,P.useEffect)(()=>{let e=sessionStorage.getItem("prefilledRequirements");e&&(e3(t=>({...t,specialRequests:e})),sessionStorage.removeItem("prefilledService"),sessionStorage.removeItem("prefilledRequirements"))},[]);let tl=async()=>{let{data:e}=await S.N.from("vehicles").select("\n      *,\n      vehicle_photos (\n        photo_url\n      )\n    ").ilike("status","Available").order("reg"),{data:t}=await S.N.from("pricing_extras").select("*"),{data:s}=await S.N.from("blocked_dates").select("id, start_date, end_date, vehicle_id, reason");if(e){g(e),e.map(e=>e.monthly_rent||e.daily_rent||0).filter(e=>e>0);let t=e.map(e=>e.daily_rent).filter(e=>null!=e&&e>0),s=e.map(e=>e.weekly_rent).filter(e=>null!=e&&e>0),a=e.map(e=>e.monthly_rent).filter(e=>null!=e&&e>0);if(t.length>0){let e=[Math.min(...t),Math.max(...t)];eY(e),eX(t=>({...t,dailyPriceRange:e}))}if(s.length>0){let e=[Math.min(...s),Math.max(...s)];eW(e),eX(t=>({...t,weeklyPriceRange:e}))}if(a.length>0){let e=[Math.min(...a),Math.max(...a)];eQ(e),eX(t=>({...t,monthlyPriceRange:e}))}}if(t&&v(t),s){eS(s);let e=s.filter(e=>null===e.vehicle_id),t=[];e.forEach(e=>{let s=new Date(e.start_date),a=new Date(e.end_date),r=new Date(s);for(;r<=a;)t.push((0,ed.GP)(r,"yyyy-MM-dd")),r.setDate(r.getDate()+1)}),e_(t)}},ti=async e=>{try{let{data:t,error:s}=await S.N.from("identity_verifications").select("review_result, status, review_status").eq("session_id",e).maybeSingle();if(s)return console.error("Error checking verification status:",s),null;return t}catch(e){return console.error("Error checking verification:",e),null}},to=()=>{e7(null),te("init"),e3(e=>({...e,verificationSessionId:""})),localStorage.removeItem("verificationSessionId"),localStorage.removeItem("verificationToken"),localStorage.removeItem("verificationStatus"),H.oR.info("Verification cleared. You can verify again.")},tn=async()=>{if(!e5.customerName||!e5.customerEmail||!e5.customerPhone)return void H.oR.error("Please fill in your name, email, and phone number first");ts(!0);let e=window.open("about:blank","_blank","width=800,height=600");try{let{data:t,error:s}=await S.N.functions.invoke("create-veriff-session",{body:{customerDetails:{name:e5.customerName,email:e5.customerEmail,phone:e5.customerPhone}}});if(s)throw s;if((null==t?void 0:t.ok)&&(null==t?void 0:t.sessionUrl)){e7(t.verificationId),te("pending"),e3(e=>({...e,verificationSessionId:t.verificationId})),console.log("✅ Stored verification session ID in formData:",t.verificationId),localStorage.setItem("verificationSessionId",t.verificationId),localStorage.setItem("verificationToken",t.sessionToken),localStorage.setItem("verificationStatus","pending"),e&&(e.location.href=t.sessionUrl),H.oR.success("Verification window opened. Please complete the identity verification.");let s=setInterval(async()=>{let e=await ti(t.verificationId);e&&("GREEN"===e.review_result?(te("verified"),localStorage.setItem("verificationStatus","verified"),H.oR.success("Identity verification successful!"),clearInterval(s),window.gtag&&window.gtag("event","verification_completed",{email:e5.customerEmail,result:"verified"})):"RED"===e.review_result&&(te("rejected"),localStorage.setItem("verificationStatus","rejected"),H.oR.error("Identity verification failed. Please try again."),clearInterval(s),window.gtag&&window.gtag("event","verification_completed",{email:e5.customerEmail,result:"rejected"})))},3e3);setTimeout(()=>clearInterval(s),3e5),window.gtag&&window.gtag("event","verification_started",{email:e5.customerEmail})}else throw Error((null==t?void 0:t.error)||"Failed to create verification session")}catch(t){console.error("Verification error:",t),H.oR.error(t.message||"Failed to start verification"),e&&e.close(),window.gtag&&window.gtag("event","verification_failed",{error:t.message})}finally{ts(!1)}},tc=async()=>{let{pickupLat:e,pickupLon:t,dropoffLat:s,dropoffLon:a}=ta;if(!e||!t||!s||!a)return void H.oR.error("Please select both pickup and dropoff locations from the suggestions");D(!0);try{let r=await fetch("https://router.project-osrm.org/route/v1/driving/".concat(t,",").concat(e,";").concat(a,",").concat(s,"?overview=false"));if(r.ok){let e=await r.json();if(e.routes&&e.routes.length>0){let t=Math.round(e.routes[0].distance/1609.34*10)/10,s=Math.round(e.routes[0].duration/60);$(t),H.oR.success("Driving distance: ".concat(t," miles (approx. ").concat(s," min)"))}else throw Error("No route found")}else throw Error("Failed to calculate route")}catch(l){console.error("Error calculating driving distance:",l);let r=((e,t,s,a)=>{let r=(s-e)*Math.PI/180,l=(a-t)*Math.PI/180,i=Math.sin(r/2)*Math.sin(r/2)+Math.cos(e*Math.PI/180)*Math.cos(s*Math.PI/180)*Math.sin(l/2)*Math.sin(l/2);return Math.round(2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))*39588)/10})(e,t,s,a);$(r),H.oR.warning("Estimated distance: ".concat(r," miles (straight-line, route unavailable)"))}finally{D(!1)}},td=e=>{e1(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},tm=e=>{if(!e.description)return null;let t=e2.has(e.id),s=e.description.length>120;return t||!s?e.description:e.description.substring(0,120)+"..."},tu=()=>{if(!e5.pickupDate||!e5.dropoffDate||!e5.pickupTime||!e5.dropoffTime)return null;let e=new Date("".concat(e5.pickupDate,"T").concat(e5.pickupTime,":00")),t=new Date("".concat(e5.dropoffDate,"T").concat(e5.dropoffTime,":00")),s=(0,em.M)(t,e),a=Math.floor(s/24),r=s%24;return{hours:s,days:a,remainingHours:r,isValid:s>=24&&a<=365,formatted:r>0?"".concat(a,"d ").concat(r,"h"):"".concat(a," day").concat(1!==a?"s":"")}},tx=e=>{if(!e5.pickupDate||!e5.dropoffDate)return null;let t=tu();if(!t)return null;let s=t.days,a=0,r=e.daily_rent||0,l=e.weekly_rent||0,i=e.monthly_rent||0;return s>=28&&i>0?a=Math.floor(s/30)*i+(r>0?s%30*r:0):s>=7&&l>0?a=Math.floor(s/7)*l+(r>0?s%7*r:0):r>0?a=s*r:i>0&&(a=i/30*s),{total:a,days:s}},tp=()=>{var e;if(!e4)return 0;let t=(null==(e=tu())?void 0:e.days)||0;if(t>=30&&e4.price_per_month){let e=Math.ceil(t/30);return e4.price_per_month*e}if(!(t>=7)||!e4.price_per_week)return(e4.price_per_day||0)*t;{let e=Math.ceil(t/7);return e4.price_per_week*e}},th=e=>{let t=tu(),s=(null==t?void 0:t.days)||0,a=e.daily_rent||0,r=e.weekly_rent||0,l=e.monthly_rent||0,i=e=>e.filter(Boolean).join(" • ");return t&&0!==s?s<7?{price:a||l,label:"/ day",secondary:i([r?"$"+r+" / week":"",l?"$"+l+" / month":""])}:s<28?{price:r||a,label:"/ week",secondary:i([a?"$"+a+" / day":"",l?"$"+l+" / month":""])}:{price:l||r||a,label:"/ month",secondary:i([a?"$"+a+" / day":"",r?"$"+r+" / week":""])}:{price:l||a,label:"/ month",secondary:i([a?"$"+a+" / day":"",r?"$"+r+" / week":""])}},tg=[...new Set(u.map(e=>e.colour).filter(Boolean))].sort(),tf=(()=>{let e=[...u];if(eM.trim()){let t=eM.toLowerCase();e=e.filter(e=>e.make&&e.make.toLowerCase().includes(t)||e.model&&e.model.toLowerCase().includes(t)||e.reg.toLowerCase().includes(t))}switch(e=e.filter(e=>{let t=e.daily_rent||0,s=e.weekly_rent||0,a=e.monthly_rent||0,r=t>=eK.dailyPriceRange[0]&&t<=eK.dailyPriceRange[1],l=s>=eK.weeklyPriceRange[0]&&s<=eK.weeklyPriceRange[1],i=a>=eK.monthlyPriceRange[0]&&a<=eK.monthlyPriceRange[1];return r&&l&&i}),eK.colors&&(eK.colors||[]).length>0&&(e=e.filter(e=>e.colour&&(eK.colors||[]).includes(e.colour))),ez){case"price_low":e.sort((e,t)=>(e.monthly_rent||e.daily_rent||0)-(t.monthly_rent||t.daily_rent||0));break;case"price_high":e.sort((e,t)=>{let s=e.monthly_rent||e.daily_rent||0;return(t.monthly_rent||t.daily_rent||0)-s});break;case"seats_most":break;case"newest":e.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime());break;default:e.sort((e,t)=>{let s="".concat(e.make||""," ").concat(e.model||"").trim().toLowerCase(),a="".concat(t.make||""," ").concat(t.model||"").trim().toLowerCase();return s.localeCompare(a)})}return e})(),tv=e=>{eF(e),localStorage.setItem("viewMode",e)},tj=()=>{eT(""),eO([]),eX({transmission:[],fuel:[],seats:[2,7],dailyPriceRange:eJ,weeklyPriceRange:eU,monthlyPriceRange:eH,colors:[]}),eV("recommended")},tb=eM||eq.length>0||"recommended"!==ez||(eK.colors||[]).length>0,ty=u.find(e=>e.id===e5.vehicleId),tN=ty?tx(ty):null;(()=>{let e=u.find(e=>e.id===e5.vehicleId);if(!e)return;let t=0,s=0;if(e5.pickupDate&&e5.dropoffDate){let a=new Date(e5.pickupDate);if((s=Math.max(1,Math.ceil((new Date(e5.dropoffDate).getTime()-a.getTime())/864e5)))>=30){let a=Math.floor(s/30),r=s%30;t=a*(e.monthly_rent||0)+r*(e.daily_rent||0)}else if(s>=7){let a=Math.floor(s/7),r=s%7;t=a*(e.weekly_rent||0)+r*(e.daily_rent||0)}else t=s*(e.daily_rent||0)}b.reduce((e,t)=>{let s=f.find(e=>e.id===t);return e+((null==s?void 0:s.price)||0)},0)})();let tw=(e,t)=>{let s={};switch(e){case"pickupLocation":if(t.trim()){let e=t.trim();e.length<5?s.pickupLocation="Please enter a valid pickup address (minimum 5 characters)":/[a-zA-Z]{3,}/.test(e)?/^[@#$%^&*()_+=\-\[\]{};:'",.<>?\/\\|`~!]{3,}/.test(e)?s.pickupLocation="Please enter a valid pickup address, not symbols":/^[a-zA-Z]+$/.test(e)&&e.length<15?s.pickupLocation="Please enter a complete address (e.g., street name, city, postcode)":/[\d]/.test(e)||/[,]/.test(e)||!(e.split(" ").length<2)||(s.pickupLocation="Please enter a complete address with street name or postcode"):s.pickupLocation="Please enter a meaningful pickup address with letters"}else s.pickupLocation="Pickup location is required";break;case"dropoffLocation":if(t.trim()){let e=t.trim();e.length<5?s.dropoffLocation="Please enter a valid drop-off address (minimum 5 characters)":/[a-zA-Z]{3,}/.test(e)?/^[@#$%^&*()_+=\-\[\]{};:'",.<>?\/\\|`~!]{3,}/.test(e)?s.dropoffLocation="Please enter a valid drop-off address, not symbols":/^[a-zA-Z]+$/.test(e)&&e.length<15?s.dropoffLocation="Please enter a complete address (e.g., street name, city, postcode)":/[\d]/.test(e)||/[,]/.test(e)||!(e.split(" ").length<2)||(s.dropoffLocation="Please enter a complete address with street name or postcode"):s.dropoffLocation="Please enter a meaningful drop-off address with letters"}else s.dropoffLocation="Drop-off location is required";break;case"customerName":let a=t.trim();a?a.length<2?s.customerName="Full name must be at least 2 characters":/^[a-zA-Z\s\-']+$/.test(a)?/[a-zA-Z]{2,}/.test(a)?a.replace(/[\s\-']/g,"").length<2&&(s.customerName="Name must have actual alphabetic content"):s.customerName="Name must contain at least 2 alphabetic characters":s.customerName="Name must contain only letters, spaces, hyphens, and apostrophes":s.customerName="Full name is required";break;case"customerEmail":t.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)||(s.customerEmail="Please enter a valid email address"):s.customerEmail="Email address is required";break;case"customerPhone":let r=t.trim();if(r){let e=r.replace(/[\s\-()]/g,""),t=(e.match(/\d/g)||[]).length;t<7||t>15?s.customerPhone="Please enter a valid phone number (7-15 digits)":e.startsWith("+")&&!/^\+\d+$/.test(e)?s.customerPhone="Invalid phone number format":e.startsWith("+")||/^\d+$/.test(e.replace(/[\s\-()]/g,""))||(s.customerPhone="Phone number should contain only digits")}else s.customerPhone="Phone number is required";break;case"customerType":t&&""!==t.trim()?"Individual"!==t&&"Company"!==t&&(s.customerType="Invalid customer type selected"):s.customerType="Please select a customer type";break;case"driverAge":t&&""!==t.trim()?["under_25","25_70","over_70"].includes(t)||(s.driverAge="Please select a valid driver age range."):s.driverAge="Please select driver age range."}eC(t=>({...t,[e]:s[e]||""}))},tk=()=>{if((()=>{let e={};return e5.vehicleId||(e.vehicleId="Please select a vehicle",H.oR.error("Please select a vehicle to continue")),eC(e),0===Object.keys(e).length})()){if(window.gtag&&ty&&tN){let e=ty.make&&ty.model?"".concat(ty.make," ").concat(ty.model):ty.make||ty.model||ty.reg;window.gtag("event","continue_to_extras_clicked",{vehicle_id:e5.vehicleId,vehicle_name:e,est_total:tN.total})}let e=JSON.parse(localStorage.getItem("booking_context")||"{}");localStorage.setItem("booking_context",JSON.stringify({...e,vehicle_id:e5.vehicleId,viewMode:e$,filters:{search:eM,categories:eq,sortBy:ez}})),m(3)}},t_=async()=>{console.log("\uD83D\uDE80 handleStep3Continue called"),console.log("\uD83D\uDD10 Current verification status:",e9),console.log("\uD83D\uDD18 Button disabled state:","verified"!==e9);let e=(()=>{console.log("\uD83D\uDD0D validateStep3 called"),console.log("\uD83D\uDCDD Current formData:",{customerName:e5.customerName,customerEmail:e5.customerEmail,customerPhone:e5.customerPhone,customerType:e5.customerType,licenseNumber:e5.licenseNumber}),console.log("\uD83D\uDD10 Verification status:",e9);let e={},t=e5.customerName.trim();t?t.length<2?e.customerName="Full name must be at least 2 characters":/^[a-zA-Z\s\-']+$/.test(t)?/[a-zA-Z]{2,}/.test(t)?t.replace(/[\s\-']/g,"").length<2&&(e.customerName="Name must have actual alphabetic content"):e.customerName="Name must contain at least 2 alphabetic characters":e.customerName="Name must contain only letters, spaces, hyphens, and apostrophes":e.customerName="Full name is required",e5.customerEmail.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e5.customerEmail)||(e.customerEmail="Please enter a valid email address"):e.customerEmail="Email address is required";let s=e5.customerPhone.trim();if(s){let t=s.replace(/[\s\-()]/g,""),a=(t.match(/\d/g)||[]).length;a<7||a>15?e.customerPhone="Please enter a valid phone number (7-15 digits)":t.startsWith("+")&&!/^\+\d+$/.test(t)?e.customerPhone="Invalid phone number format":t.startsWith("+")||/^\d+$/.test(t.replace(/[\s\-()]/g,""))||(e.customerPhone="Phone number should contain only digits")}else e.customerPhone="Phone number is required";return e5.customerType&&""!==e5.customerType.trim()?"Individual"!==e5.customerType&&"Company"!==e5.customerType&&(e.customerType="Invalid customer type selected"):e.customerType="Please select a customer type",console.log("\uD83D\uDCCB All validation errors:",e),console.log("✅ Validation result:",0===Object.keys(e).length?"PASSED":"FAILED"),eC(e),0===Object.keys(e).length})();if(console.log("✨ Validation returned:",e),!e)return void console.log("❌ Validation failed! Not moving to step 4");console.log("✅ Validation passed! Moving to step 4"),window.gtag&&window.gtag("event","booking_step3_submitted",{customer_type:e5.customerType,verification_status:e9}),m(4)};return C&&E?(0,a.jsx)(eu.A,{bookingDetails:E,onClose:()=>{A(!1),m(1),e3({pickupLocation:"",dropoffLocation:"",pickupDate:"",dropoffDate:"",pickupTime:"",dropoffTime:"",specialRequests:"",vehicleId:"",driverAge:"",promoCode:"",customerName:"",customerEmail:"",customerPhone:"",customerType:"",licenseNumber:""}),y([]),$(null),Y(!1),ep(!1)}}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("section",{className:"bk-hero",children:(0,a.jsxs)("div",{className:"bk-hero__inner",children:[(0,a.jsx)("h1",{className:"bk-hero__title",children:(()=>{var e;let t=(null==(e=eE.booking_header)?void 0:e.title)||"Book Your Rental";switch(d){case 1:default:return t;case 2:return"Choose Vehicle";case 3:return"Your Details";case 4:return"Review & Confirm"}})()}),(0,a.jsx)("div",{className:"flex items-center justify-center mt-4",children:(0,a.jsx)("div",{className:"h-[1px] w-24 bg-gradient-to-r from-transparent via-primary to-transparent"})}),(0,a.jsx)("p",{className:"bk-hero__subtitle",children:(null==(e=eE.booking_header)?void 0:e.subtitle)||"Quick, easy, and affordable car rentals in Dallas — from pickup to drop-off, we've got you covered."}),(0,a.jsx)("p",{className:"bk-hero__meta",children:((null==(t=eE.booking_header)?void 0:t.trust_points)||["Dallas–Fort Worth Area","Transparent Rates","24/7 Support"]).join(" \xb7 ")})]})}),(0,a.jsx)(w.Zp,{ref:ew,className:"p-4 md:p-8 bg-card backdrop-blur-sm border-border shadow-[0_8px_30px_rgba(0,0,0,0.12)] dark:shadow-[0_8px_30px_rgba(0,0,0,0.4)]",children:(0,a.jsxs)("div",{className:"space-y-8 bk-steps",children:[(0,a.jsx)("div",{className:"w-full overflow-x-auto py-4",children:(0,a.jsx)("div",{className:"flex items-center justify-between relative min-w-[280px]",children:[{step:1,label:"Trip",fullLabel:"Trip Details"},{step:2,label:"Vehicle",fullLabel:"Choose Vehicle"},{step:3,label:"Details",fullLabel:"Customer Details"},{step:4,label:"Review",fullLabel:"Review & Confirm"}].map((e,t)=>{let{step:s,label:r,fullLabel:l}=e;return(0,a.jsxs)("div",{className:"flex flex-col items-center flex-1 relative z-10",children:[(0,a.jsx)("div",{className:(0,G.cn)("bk-step__node flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 md:w-14 md:h-14 rounded-full border-2 transition-all",d>=s?"bg-primary border-primary shadow-glow":"border-border bg-muted",d===s&&"bk-step__node--active shadow-glow"),"aria-label":"Step ".concat(s," of 4: ").concat(l),"aria-current":d===s?"step":void 0,children:d>s?(0,a.jsx)(K.A,{className:"w-4 h-4 sm:w-5 sm:h-5 md:w-6 md:h-6 text-primary-foreground"}):(0,a.jsx)("span",{className:(0,G.cn)("text-base sm:text-lg md:text-xl font-bold",d===s?"text-primary-foreground":"text-muted-foreground"),children:s})}),(0,a.jsxs)("span",{className:"mt-1.5 sm:mt-2 text-[10px] sm:text-xs md:text-sm font-medium text-center leading-tight ".concat(d>=s?"text-primary":"text-muted-foreground"),children:[(0,a.jsx)("span",{className:"hidden sm:inline",children:l}),(0,a.jsx)("span",{className:"sm:hidden",children:r})]}),t<3&&(0,a.jsx)("div",{className:(0,G.cn)("bk-step__line absolute top-5 sm:top-6 md:top-7 left-[calc(50%+20px)] sm:left-[calc(50%+24px)] md:left-[calc(50%+28px)] w-[calc(100%-40px)] sm:w-[calc(100%-48px)] md:w-[calc(100%-56px)] h-0.5",d>s?"bg-primary":"bg-border")})]},s)})})}),1===d&&(0,a.jsxs)("div",{className:"space-y-8 animate-fade-in",children:[(0,a.jsx)("div",{children:(0,a.jsx)("h3",{className:"text-2xl md:text-3xl font-display font-semibold text-foreground pb-2 border-b-2 border-primary/30",children:"Rental Details"})}),(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z.J,{htmlFor:"pickupLocation",className:"font-medium",children:"Pickup *"}),(0,a.jsx)(eg.A,{id:"pickupLocation",value:e5.pickupLocation,onChange:(e,t,s)=>{e3({...e5,pickupLocation:e}),tr({...ta,pickupLat:t||null,pickupLon:s||null}),tw("pickupLocation",e)},placeholder:"Enter pickup address",className:"h-12 focus-visible:ring-primary"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Start typing a Dallas address or landmark"}),eD.pickupLocation&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:eD.pickupLocation})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(z.J,{htmlFor:"dropoffLocation",className:"font-medium",children:"Return *"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(O,{id:"sameAsPickup",checked:eA,onCheckedChange:e=>{eL(e),e||(e3(e=>({...e,dropoffLocation:""})),tr(e=>({...e,dropoffLat:null,dropoffLon:null})))},"aria-label":"Same as pickup location"}),(0,a.jsx)(z.J,{htmlFor:"sameAsPickup",className:"text-xs cursor-pointer font-normal",children:"Same as pickup"})]})]}),(0,a.jsx)(eg.A,{id:"dropoffLocation",value:e5.dropoffLocation,onChange:(e,t,s)=>{e3({...e5,dropoffLocation:e}),tr({...ta,dropoffLat:t||null,dropoffLon:s||null}),tw("dropoffLocation",e)},placeholder:"Enter return address",className:"h-12 focus-visible:ring-primary",disabled:eA}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Start typing a Dallas address or landmark"}),eD.dropoffLocation&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:eD.dropoffLocation})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(z.J,{className:"font-medium",children:"Pickup *"}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground px-2 py-0.5 bg-muted rounded",children:"PST/PDT"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(B.AM,{children:[(0,a.jsx)(B.Wv,{asChild:!0,children:(0,a.jsxs)(L.$,{variant:"outline",className:(0,G.cn)("w-full justify-start text-left font-normal h-12",!e5.pickupDate&&"text-muted-foreground"),children:[(0,a.jsx)(X.A,{className:"mr-2 h-4 w-4"}),e5.pickupDate?(0,ed.GP)(new Date(e5.pickupDate),"MMM dd"):(0,a.jsx)("span",{children:"Date"})]})}),(0,a.jsx)(B.hl,{className:"w-auto p-0",align:"start",children:(0,a.jsx)(Z.V,{mode:"single",selected:e5.pickupDate?new Date(e5.pickupDate):void 0,onSelect:e=>{if(e){let t=(0,ed.GP)(e,"yyyy-MM-dd");if(ek.includes(t))return void H.oR.error("This date is not available for booking.");e3({...e5,pickupDate:t}),eD.pickupDate&&eC({...eD,pickupDate:""})}},disabled:e=>{let t=(0,ed.GP)(e,"yyyy-MM-dd"),s=new Date(new Date().setHours(0,0,0,0)),a=new Date(s);return a.setFullYear(a.getFullYear()+1),e<s||e>a||ek.includes(t)},initialFocus:!0,className:"pointer-events-auto"})})]}),(0,a.jsx)(J,{id:"pickupTime",value:e5.pickupTime,onChange:e=>{e3({...e5,pickupTime:e}),eD.pickupTime&&eC({...eD,pickupTime:""})},className:"h-12 focus-visible:ring-primary"})]}),eD.pickupDate&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:eD.pickupDate}),eD.pickupTime&&!eD.pickupDate&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:eD.pickupTime})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(z.J,{className:"font-medium",children:"Return *"}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground px-2 py-0.5 bg-muted rounded",children:"PST/PDT"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(B.AM,{children:[(0,a.jsx)(B.Wv,{asChild:!0,children:(0,a.jsxs)(L.$,{variant:"outline",className:(0,G.cn)("w-full justify-start text-left font-normal h-12",!e5.dropoffDate&&"text-muted-foreground"),children:[(0,a.jsx)(X.A,{className:"mr-2 h-4 w-4"}),e5.dropoffDate?(0,ed.GP)(new Date(e5.dropoffDate),"MMM dd"):(0,a.jsx)("span",{children:"Date"})]})}),(0,a.jsx)(B.hl,{className:"w-auto p-0",align:"start",children:(0,a.jsx)(Z.V,{mode:"single",selected:e5.dropoffDate?new Date(e5.dropoffDate):void 0,onSelect:e=>{if(e){let t=(0,ed.GP)(e,"yyyy-MM-dd");e3({...e5,dropoffDate:t}),eD.dropoffDate&&eC({...eD,dropoffDate:""})}},disabled:e=>{let t=e5.pickupDate?new Date(e5.pickupDate):new Date,s=new Date(t);s.setFullYear(s.getFullYear()+1);let a=(0,ed.GP)(e,"yyyy-MM-dd");return e<=t||e>s||ek.includes(a)},initialFocus:!0,className:"pointer-events-auto"})})]}),(0,a.jsx)(J,{id:"dropoffTime",value:e5.dropoffTime,onChange:e=>{e3({...e5,dropoffTime:e}),eD.dropoffTime&&eC({...eD,dropoffTime:""})},className:"h-12 focus-visible:ring-primary"})]}),eD.dropoffDate&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:eD.dropoffDate}),eD.dropoffTime&&!eD.dropoffDate&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:eD.dropoffTime})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z.J,{htmlFor:"driverAge",className:"font-medium",children:"Driver's Age *"}),(0,a.jsxs)(V.l6,{value:e5.driverAge,onValueChange:e=>{e3({...e5,driverAge:e}),tw("driverAge",e)},children:[(0,a.jsx)(V.bq,{id:"driverAge",className:"h-12 focus-visible:ring-primary",children:(0,a.jsx)(V.yv,{placeholder:"Select age range"})}),(0,a.jsxs)(V.gC,{position:"popper",sideOffset:4,children:[(0,a.jsx)(V.eb,{value:"under_25",children:"Under 25"}),(0,a.jsx)(V.eb,{value:"25_70",children:"25–70"}),(0,a.jsx)(V.eb,{value:"over_70",children:"70+"})]})]}),eD.driverAge&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:eD.driverAge}),"under_25"===e5.driverAge&&(0,a.jsx)("p",{className:"text-xs text-primary",children:"Young Driver Fee will apply"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z.J,{htmlFor:"promoCode",className:"font-medium",children:"Promo Code"}),(0,a.jsx)(F.p,{id:"promoCode",value:e5.promoCode,onChange:e=>{let t=e.target.value.toUpperCase();e3({...e5,promoCode:t})},placeholder:"Enter promo code",className:"h-12 focus-visible:ring-primary",maxLength:20})]})]})]}),(0,a.jsxs)(L.$,{onClick:()=>{if((()=>{let e={};if(e5.pickupLocation.trim()){let t=e5.pickupLocation.trim();t.length<5?e.pickupLocation="Please enter a valid pickup address (minimum 5 characters)":/[a-zA-Z]{3,}/.test(t)?/^[@#$%^&*()_+=\-\[\]{};:'",.<>?\/\\|`~!]{3,}/.test(t)?e.pickupLocation="Please enter a valid pickup address, not symbols":/^[a-zA-Z]+$/.test(t)&&t.length<15?e.pickupLocation="Please enter a complete address (e.g., street name, city, postcode)":/[\d]/.test(t)||/[,]/.test(t)||!(t.split(" ").length<2)||(e.pickupLocation="Please enter a complete address with street name or postcode"):e.pickupLocation="Please enter a meaningful pickup address with letters"}else e.pickupLocation="Pickup location is required";if(e5.dropoffLocation.trim()){let t=e5.dropoffLocation.trim();t.length<5?e.dropoffLocation="Please enter a valid drop-off address (minimum 5 characters)":/[a-zA-Z]{3,}/.test(t)?/^[@#$%^&*()_+=\-\[\]{};:'",.<>?\/\\|`~!]{3,}/.test(t)?e.dropoffLocation="Please enter a valid drop-off address, not symbols":/^[a-zA-Z]+$/.test(t)&&t.length<15?e.dropoffLocation="Please enter a complete address (e.g., street name, city, postcode)":/[\d]/.test(t)||/[,]/.test(t)||!(t.split(" ").length<2)||(e.dropoffLocation="Please enter a complete address with street name or postcode"):e.dropoffLocation="Please enter a meaningful drop-off address with letters"}else e.dropoffLocation="Drop-off location is required";if(e5.pickupDate||(e.pickupDate="Please select a pickup location."),e5.pickupTime||(e.pickupTime="Please choose pickup and return date & time."),e5.dropoffDate||(e.dropoffDate="Please choose pickup and return date & time."),e5.dropoffTime||(e.dropoffTime="Please choose pickup and return date & time."),e5.pickupDate&&e5.dropoffDate&&e5.pickupTime&&e5.dropoffTime){let t=tu();t&&!t.isValid&&(t.hours<24?e.dropoffDate="Return must be at least 24 hours after pickup.":t.days>365&&(e.dropoffDate="Maximum rental period is 1 year."))}return e5.driverAge&&""!==e5.driverAge.trim()?["under_25","25_70","over_70"].includes(e5.driverAge)||(e.driverAge="Please select a valid driver age range."):e.driverAge="Please select driver age range.",eC(e),0===Object.keys(e).length})()){let e={pickupLocation:e5.pickupLocation,dropoffLocation:e5.dropoffLocation,pickupDate:e5.pickupDate,pickupTime:e5.pickupTime,dropoffDate:e5.dropoffDate,dropoffTime:e5.dropoffTime,driverAge:e5.driverAge,promoCode:e5.promoCode,young_driver:"under_25"===e5.driverAge};localStorage.setItem("booking_context",JSON.stringify(e)),console.log("\uD83D\uDCDD Moving to Step 2 with formData:",e5),console.log("\uD83D\uDCDD Verification Session ID in formData:",e5.verificationSessionId);let t=tu();window.gtag&&window.gtag("event","booking_step1_submitted",{pickup_location:e5.pickupLocation,return_location:e5.dropoffLocation,rental_days:(null==t?void 0:t.days)||0,driver_age:e5.driverAge,has_promo:!!e5.promoCode,young_driver:"under_25"===e5.driverAge}),m(2)}},className:"w-full h-12 bg-primary hover:bg-primary/90 text-primary-foreground font-semibold text-base shadow-md hover:shadow-lg transition-all",size:"lg",children:["Continue to Vehicle Selection ",(0,a.jsx)(ee.A,{className:"ml-2 w-5 h-5"})]})]}),2===d&&(0,a.jsxs)("div",{className:"space-y-6 animate-fade-in",children:[(0,a.jsxs)(L.$,{onClick:()=>m(1),variant:"ghost",className:"text-primary hover:text-primary/80 -ml-2",children:[(0,a.jsx)(et.A,{className:"mr-1 w-5 h-5"})," Back to Trip Details"]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-3xl md:text-4xl font-display font-semibold text-foreground",children:"Select"}),(0,a.jsx)("p",{className:"text-muted-foreground text-base",children:"Choose from our curated fleet of premium rentals."}),e5.pickupDate&&e5.dropoffDate&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,a.jsx)(X.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:[(0,ed.GP)(new Date(e5.pickupDate),"MMM dd")," → ",(0,ed.GP)(new Date(e5.dropoffDate),"MMM dd")]}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:e5.pickupLocation.split(",")[0]||"Selected location"}),(0,a.jsx)("span",{children:"•"}),(0,a.jsxs)("span",{children:[(null==(s=tu())?void 0:s.days)||0," ",1===((null==(r=tu())?void 0:r.days)||0)?"day":"days"]})]})]}),(0,a.jsx)(w.Zp,{className:"p-4 bg-card/90 backdrop-blur-sm border-primary/15 shadow-lg",children:(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(es.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,a.jsx)(F.p,{value:eM,onChange:e=>(e=>{eT(e),e0.current&&clearTimeout(e0.current),e0.current=setTimeout(()=>{window.gtag&&window.gtag("event","fleet_search_changed",{term:e})},250)})(e.target.value),placeholder:"Search cars…",className:"pl-10 h-10 bg-background focus-visible:ring-primary","aria-label":"Search vehicles"})]}),(0,a.jsxs)(V.l6,{value:ez,onValueChange:e=>{eV(e),window.gtag&&window.gtag("event","fleet_sort_changed",{sortKey:e})},children:[(0,a.jsx)(V.bq,{className:"w-full sm:w-[200px] h-10 focus-visible:ring-primary",children:(0,a.jsx)(V.yv,{placeholder:"Sort by"})}),(0,a.jsxs)(V.gC,{className:"bg-card border-primary/20",children:[(0,a.jsx)(V.eb,{value:"recommended",children:"Recommended"}),(0,a.jsx)(V.eb,{value:"price_low",children:"Price: Low → High"}),(0,a.jsx)(V.eb,{value:"price_high",children:"Price: High → Low"}),(0,a.jsx)(V.eb,{value:"seats_most",children:"Seats: Most → Fewest"}),(0,a.jsx)(V.eb,{value:"newest",children:"Newest Models"})]})]}),(0,a.jsxs)(B.AM,{open:eZ,onOpenChange:eB,children:[(0,a.jsx)(B.Wv,{asChild:!0,children:(0,a.jsxs)(L.$,{variant:"outline",className:"h-10 gap-2 border-primary/30 hover:bg-primary/10",children:[(0,a.jsx)(ea.A,{className:"w-4 h-4"}),"Filters",(eK.colors||[]).length>0&&(0,a.jsx)(W.E,{className:"ml-1 h-5 w-5 rounded-full p-0 bg-primary text-primary-foreground",children:(eK.colors||[]).length})]})}),(0,a.jsx)(B.hl,{className:"w-80 bg-card border-primary/20 p-4",align:"end",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h4",{className:"font-semibold",children:"Filters"}),(0,a.jsx)(L.$,{variant:"ghost",size:"sm",onClick:()=>{eX({transmission:[],fuel:[],seats:[2,7],dailyPriceRange:eJ,weeklyPriceRange:eU,monthlyPriceRange:eH,colors:[]})},children:"Reset"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(z.J,{className:"text-sm font-medium",children:["Daily: $",eK.dailyPriceRange[0]," - $",eK.dailyPriceRange[1]]}),(0,a.jsx)(U,{value:eK.dailyPriceRange,onValueChange:e=>eX(t=>({...t,dailyPriceRange:e})),min:eJ[0],max:eJ[1],step:5,className:"py-2"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(z.J,{className:"text-sm font-medium",children:["Weekly: $",eK.weeklyPriceRange[0]," - $",eK.weeklyPriceRange[1]]}),(0,a.jsx)(U,{value:eK.weeklyPriceRange,onValueChange:e=>eX(t=>({...t,weeklyPriceRange:e})),min:eU[0],max:eU[1],step:10,className:"py-2"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(z.J,{className:"text-sm font-medium",children:["Monthly: $",eK.monthlyPriceRange[0]," - $",eK.monthlyPriceRange[1]]}),(0,a.jsx)(U,{value:eK.monthlyPriceRange,onValueChange:e=>eX(t=>({...t,monthlyPriceRange:e})),min:eH[0],max:eH[1],step:20,className:"py-2"})]}),tg.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z.J,{className:"text-sm font-medium",children:"Color"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:tg.map(e=>(0,a.jsx)("button",{onClick:()=>eX(t=>({...t,colors:t.colors.includes(e)?t.colors.filter(t=>t!==e):[...t.colors,e]})),className:"px-3 py-1.5 text-xs font-medium rounded-full border transition-colors ".concat((eK.colors||[]).includes(e)?"bg-primary text-primary-foreground border-primary":"bg-background border-border hover:border-primary/50"),children:e},e))})]})]})})]}),(0,a.jsxs)("div",{className:"flex gap-1 border border-primary/30 rounded-md p-1",children:[(0,a.jsx)(L.$,{variant:"ghost",size:"sm",className:(0,G.cn)("h-8 w-8 p-0","grid"===e$&&"bg-primary/20 text-primary"),onClick:()=>tv("grid"),"aria-label":"Grid view",children:(0,a.jsx)(er.A,{className:"w-4 h-4"})}),(0,a.jsx)(L.$,{variant:"ghost",size:"sm",className:(0,G.cn)("h-8 w-8 p-0","list"===e$&&"bg-primary/20 text-primary"),onClick:()=>tv("list"),"aria-label":"List view",children:(0,a.jsx)(el.A,{className:"w-4 h-4"})})]})]}),tb&&(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2 pt-2 border-t border-border/50",children:[(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"Active filters:"}),eM&&(0,a.jsxs)(W.E,{variant:"secondary",className:"gap-1",children:["Search: ",eM,(0,a.jsx)(ei.A,{className:"w-3 h-3 cursor-pointer",onClick:()=>eT("")})]}),eq.map(e=>(0,a.jsxs)(W.E,{variant:"secondary",className:"gap-1",children:[e,(0,a.jsx)(ei.A,{className:"w-3 h-3 cursor-pointer",onClick:()=>(e=>{eO(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e]),window.gtag&&window.gtag("event","fleet_filter_changed",{filter:"category",value:e})})(e)})]},e)),"recommended"!==ez&&(0,a.jsxs)(W.E,{variant:"secondary",className:"gap-1",children:[(e=>{switch(e){case"price_low":return"Price: Low → High";case"price_high":return"Price: High → Low";case"seats_most":return"Seats: Most → Fewest";case"newest":return"Newest Models";case"recommended":return"Recommended";default:return e}})(ez),(0,a.jsx)(ei.A,{className:"w-3 h-3 cursor-pointer",onClick:()=>eV("recommended")})]}),(eK.colors||[]).map(e=>(0,a.jsxs)(W.E,{variant:"secondary",className:"gap-1",children:[e,(0,a.jsx)(ei.A,{className:"w-3 h-3 cursor-pointer",onClick:()=>eX(t=>({...t,colors:t.colors.filter(t=>t!==e)}))})]},e)),(0,a.jsx)(L.$,{variant:"ghost",size:"sm",className:"h-6 text-xs text-primary hover:text-primary/80",onClick:tj,children:"Clear all"})]})]})}),eD.vehicleId&&(0,a.jsx)("div",{className:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg",children:(0,a.jsx)("p",{className:"text-sm text-destructive",children:eD.vehicleId})}),(0,a.jsxs)("div",{className:"grid lg:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-3",children:0===tf.length?(0,a.jsxs)(w.Zp,{className:"p-12 text-center bg-card/50",children:[(0,a.jsx)(p.A,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground opacity-40"}),(0,a.jsx)("p",{className:"text-lg font-medium text-foreground mb-2",children:"No vehicles match your filters"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Try adjusting your dates or categories."}),(0,a.jsx)(L.$,{variant:"outline",onClick:tj,className:"border-primary/30",children:"Clear Filters"})]}):(0,a.jsx)("div",{className:(0,G.cn)("grid gap-6","grid"===e$?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3":"grid-cols-1"),children:tf.map(e=>{var t,s,r,l,i,o,c,d;(e=>{let t=(e.make||"").toLowerCase(),s=(e.model||"").toLowerCase(),a="".concat(t," ").concat(s);return t.includes("rolls")||s.includes("phantom")?N.A:s.includes("s-class")||s.includes("s class")||a.includes("s class")?Q.A:(s.includes("v-class")||s.includes("v class")||a.includes("transit"))&&n.A})(e);let m=e.make&&e.model?"".concat(e.make," ").concat(e.model):e.make||e.model||e.reg,u=(e.make||"").toLowerCase().includes("rolls")||(e.model||"").toLowerCase().includes("phantom"),x=e5.vehicleId===e.id,h=tx(e),g=(e=>{if(!e5.pickupDate||!e5.dropoffDate)return{blocked:!1};let t=new Date(e5.pickupDate),s=new Date(e5.dropoffDate);for(let a of eP.filter(t=>t.vehicle_id===e)){let e=new Date(a.start_date);if(t<=new Date(a.end_date)&&s>=e)return{blocked:!0,blockedRange:{start:a.start_date,end:a.end_date}}}return{blocked:!1}})(e.id),f=g.blocked;return"list"===e$?(0,a.jsx)(w.Zp,{className:(0,G.cn)("group transition-all duration-300 overflow-hidden border-2 relative",f?"opacity-60 cursor-not-allowed border-destructive/30":"cursor-pointer hover:shadow-2xl",!f&&x?"border-primary bg-primary/5 shadow-glow":"border-border/30 hover:border-primary/40"),onClick:()=>{!f&&(e3({...e5,vehicleId:e.id}),eD.vehicleId&&eC({...eD,vehicleId:""}),window.gtag&&window.gtag("event","vehicle_card_viewed",{vehicle_id:e.id}))},children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row",children:[(0,a.jsxs)("div",{className:"relative w-full sm:w-64 aspect-video sm:aspect-square overflow-hidden bg-gradient-to-br from-muted/30 to-muted/5",children:[(null==(o=e.vehicle_photos)||null==(i=o[0])?void 0:i.photo_url)?(0,a.jsx)("img",{src:e.vehicle_photos[0].photo_url,alt:m,className:"w-full h-full object-cover",loading:"lazy",onError:e=>{e.currentTarget.style.display="none";let t=e.currentTarget.nextElementSibling;t&&(t.style.display="flex")}}):null,(0,a.jsx)("div",{className:"".concat((null==(d=e.vehicle_photos)||null==(c=d[0])?void 0:c.photo_url)?"hidden":"flex"," items-center justify-center h-full w-full absolute inset-0"),children:(0,a.jsx)(p.A,{className:"w-16 h-16 opacity-20 text-muted-foreground"})}),x&&(0,a.jsx)("div",{className:"absolute top-3 right-3 px-3 py-1 bg-primary text-primary-foreground text-xs font-semibold rounded-full flex items-center justify-center",children:(0,a.jsx)(K.A,{className:"w-4 h-4"})}),f&&g.blockedRange&&(0,a.jsxs)("div",{className:"absolute bottom-3 left-3 right-3 px-3 py-2 bg-destructive/90 text-white text-xs font-medium rounded-lg backdrop-blur",children:[(0,a.jsx)("p",{className:"font-semibold mb-1",children:"Unavailable"}),(0,a.jsxs)("p",{className:"text-[10px] opacity-90",children:[(0,ed.GP)(new Date(g.blockedRange.start),"MMM dd")," - ",(0,ed.GP)(new Date(g.blockedRange.end),"MMM dd")]})]})]}),(0,a.jsxs)("div",{className:"flex-1 p-6 flex flex-col justify-between",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"flex items-start justify-between gap-4",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-display text-2xl font-semibold text-foreground flex items-center justify-between w-full",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[m,u&&(0,a.jsx)(N.A,{className:"w-5 h-5 text-primary"})]}),(0,a.jsx)("span",{className:"text-sm font-normal text-primary",children:e.reg})]}),e.colour&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:e.colour})]})}),e.description&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:tm(e)}),e.description.length>120&&(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),td(e.id)},className:"text-xs text-primary hover:text-primary/80 font-medium transition-colors",children:e2.has(e.id)?"Show less":"Show more"})]})]}),(0,a.jsxs)("div",{className:"flex items-end justify-between gap-4 mt-4",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,a.jsxs)("span",{className:"text-3xl font-bold text-primary",children:["$",th(e).price]}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:th(e).label})]}),th(e).secondary&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:th(e).secondary})]}),(0,a.jsx)(L.$,{className:(0,G.cn)("w-40 h-11 font-medium transition-colors",f?"bg-muted text-muted-foreground cursor-not-allowed":x?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-background border-2 border-primary text-primary hover:bg-primary hover:text-primary-foreground"),disabled:f,onClick:t=>{!f&&(t.stopPropagation(),e3({...e5,vehicleId:e.id}),window.gtag&&window.gtag("event","vehicle_selected",{vehicle_id:e.id,est_total:(null==h?void 0:h.total)||0}))},children:f?"Unavailable":x?"Selected":"Select"})]})]})]})},e.id):(0,a.jsxs)(w.Zp,{className:(0,G.cn)("group transition-all duration-300 overflow-hidden border-2 relative",f?"opacity-60 cursor-not-allowed border-destructive/30":"cursor-pointer hover:shadow-2xl hover:scale-[1.02]",!f&&x?"border-primary bg-primary/5 shadow-glow":"border-border/30 hover:border-primary/40",!f&&u&&"shadow-glow"),onClick:()=>{!f&&(e3({...e5,vehicleId:e.id}),eD.vehicleId&&eC({...eD,vehicleId:""}),window.gtag&&window.gtag("event","vehicle_card_viewed",{vehicle_id:e.id}))},children:[x&&(0,a.jsx)("div",{className:"absolute top-3 right-3 z-20 w-6 h-6 bg-primary rounded-full flex items-center justify-center",children:(0,a.jsx)(K.A,{className:"w-4 h-4 text-black"})}),(0,a.jsxs)("div",{className:(0,G.cn)("relative aspect-video overflow-hidden bg-gradient-to-br",u?"from-primary/10 to-primary/20":"from-muted/30 to-muted/5"),children:[(null==(s=e.vehicle_photos)||null==(t=s[0])?void 0:t.photo_url)?(0,a.jsx)("img",{src:e.vehicle_photos[0].photo_url,alt:m,className:"w-full h-full object-cover",loading:"lazy",onError:e=>{e.currentTarget.style.display="none";let t=e.currentTarget.nextElementSibling;t&&(t.style.display="flex")}}):null,(0,a.jsx)("div",{className:"".concat((null==(l=e.vehicle_photos)||null==(r=l[0])?void 0:r.photo_url)?"hidden":"flex"," flex-col items-center justify-center h-full w-full absolute inset-0"),children:(0,a.jsx)(p.A,{className:(0,G.cn)("w-16 h-16 mb-2 opacity-20",u?"text-primary":"text-muted-foreground")})}),f&&g.blockedRange&&(0,a.jsxs)("div",{className:"absolute bottom-3 left-3 right-3 px-3 py-2 bg-destructive/90 text-white text-xs font-medium rounded-lg backdrop-blur",children:[(0,a.jsx)("p",{className:"font-semibold mb-1",children:"Unavailable"}),(0,a.jsxs)("p",{className:"text-[10px] opacity-90",children:[(0,ed.GP)(new Date(g.blockedRange.start),"MMM dd")," - ",(0,ed.GP)(new Date(g.blockedRange.end),"MMM dd")]})]})]}),(0,a.jsxs)("div",{className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-display text-xl font-semibold text-foreground mb-1 flex items-center justify-between w-full",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[m,u&&(0,a.jsx)(N.A,{className:"w-5 h-5 text-primary"})]}),(0,a.jsx)("span",{className:"text-xs font-normal text-primary",children:e.reg})]}),e.colour&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.colour})]}),e.description&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:tm(e)}),e.description.length>120&&(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),td(e.id)},className:"text-xs text-primary hover:text-primary/80 font-medium transition-colors",children:e2.has(e.id)?"Show less":"Show more"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-baseline justify-between",children:[(0,a.jsxs)("span",{className:"text-2xl font-bold text-primary",children:["$",th(e).price]}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:th(e).label})]}),th(e).secondary&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:th(e).secondary})]}),(0,a.jsx)(L.$,{className:(0,G.cn)("w-full h-11 font-medium transition-colors",f?"bg-muted text-muted-foreground cursor-not-allowed":x?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-background border-2 border-primary text-primary hover:bg-primary hover:text-primary-foreground"),disabled:f,onClick:t=>{!f&&(t.stopPropagation(),e3({...e5,vehicleId:e.id}),window.gtag&&window.gtag("event","vehicle_selected",{vehicle_id:e.id,est_total:(null==h?void 0:h.total)||0}))},children:f?"Unavailable":x?"Selected":"Select"})]})]},e.id)})})}),(0,a.jsx)("div",{className:"hidden lg:block",children:(0,a.jsxs)(w.Zp,{className:"sticky top-24 p-6 bg-card border-primary/20 space-y-4",children:[(0,a.jsx)("h4",{className:"font-display text-xl font-semibold",children:"Your Trip"}),(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-muted-foreground text-xs uppercase tracking-wide mb-1",children:"Pickup"}),(0,a.jsx)("p",{className:"font-medium",children:e5.pickupDate?(0,ed.GP)(new Date(e5.pickupDate),"MMM dd, yyyy"):"—"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs",children:e5.pickupTime||"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-muted-foreground text-xs uppercase tracking-wide mb-1",children:"Return"}),(0,a.jsx)("p",{className:"font-medium",children:e5.dropoffDate?(0,ed.GP)(new Date(e5.dropoffDate),"MMM dd, yyyy"):"—"}),(0,a.jsx)("p",{className:"text-muted-foreground text-xs",children:e5.dropoffTime||"—"})]}),(0,a.jsxs)("div",{className:"pt-3 border-t border-border/50",children:[(0,a.jsx)("p",{className:"text-muted-foreground text-xs uppercase tracking-wide mb-1",children:"Duration"}),(0,a.jsx)("p",{className:"font-semibold text-lg",children:(null==(l=tu())?void 0:l.formatted)||"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-muted-foreground text-xs uppercase tracking-wide mb-1",children:"Location"}),(0,a.jsx)("p",{className:"font-medium text-xs",children:e5.pickupLocation.split(",").slice(0,2).join(",")||"—"})]})]}),ty&&tN&&(0,a.jsxs)("div",{className:"pt-4 border-t border-border/50 space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex gap-3 flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-md overflow-hidden bg-muted flex-shrink-0 relative",children:(null==(o=ty.vehicle_photos)||null==(i=o[0])?void 0:i.photo_url)?(0,a.jsx)("img",{src:ty.vehicle_photos[0].photo_url,alt:ty.make&&ty.model?"".concat(ty.make," ").concat(ty.model):ty.reg,className:"w-full h-full object-cover",loading:"lazy"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,a.jsx)(p.A,{className:"w-5 h-5 text-muted-foreground opacity-30"})})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-sm truncate",children:ty.make&&ty.model?"".concat(ty.make," ").concat(ty.model):ty.reg}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[tN.days," ",1===tN.days?"day":"days"]})]})]}),(0,a.jsxs)("p",{className:"font-semibold text-sm",children:["$",tN.total.toFixed(0)]})]}),e4&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x.A,{className:"w-4 h-4 text-primary"}),(0,a.jsx)("span",{className:"text-sm",children:e4.display_name||e4.name})]}),(0,a.jsxs)("p",{className:"font-semibold text-sm",children:["$",tp().toFixed(0)]})]}),(0,a.jsxs)("div",{className:"pt-3 border-t border-border/50 flex justify-between items-center",children:[(0,a.jsx)("p",{className:"font-semibold",children:"Total"}),(0,a.jsxs)("p",{className:"text-xl font-bold text-primary",children:["$",(tN.total+tp()).toFixed(0)]})]})]}),!ty&&(0,a.jsx)("div",{className:"pt-4 border-t border-border/50",children:(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Pricing shown per day; total calculated at checkout."})}),(0,a.jsxs)(L.$,{onClick:tk,disabled:!e5.vehicleId,className:"w-full h-11 bg-primary hover:bg-primary/90 text-primary-foreground font-semibold shadow-md hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",size:"lg",children:["Review & Pay ",(0,a.jsx)(ee.A,{className:"ml-2 w-5 h-5"})]})]})})]}),e5.vehicleId&&tu()&&(0,a.jsx)("div",{className:"mt-8",ref:eN,children:(0,a.jsx)(eG,{selectedPlanId:e5.protectionPlanId,onSelectPlan:(e,t)=>{e3({...e5,protectionPlanId:e}),e6(t)},rentalDays:(null==(c=tu())?void 0:c.days)||1})}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 lg:hidden mt-8",children:[(0,a.jsxs)(L.$,{onClick:()=>m(1),variant:"outline",className:"w-full sm:flex-1 border-primary text-primary hover:bg-primary/10",size:"lg",children:[(0,a.jsx)(et.A,{className:"mr-2 w-5 h-5"})," Back"]}),(0,a.jsxs)(L.$,{onClick:tk,disabled:!e5.vehicleId,className:"w-full sm:flex-1 bg-primary hover:bg-primary/90 text-primary-foreground font-semibold shadow-md hover:shadow-lg transition-all disabled:opacity-50",size:"lg",children:["Review & Pay ",(0,a.jsx)(ee.A,{className:"ml-2 w-5 h-5"})]})]})]}),3===d&&(0,a.jsxs)("div",{className:"space-y-8 animate-fade-in",children:[(0,a.jsx)("div",{children:(0,a.jsx)("h3",{className:"text-2xl md:text-3xl font-display font-semibold text-foreground pb-2 border-b-2 border-primary/30",children:"Your Details"})}),(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z.J,{htmlFor:"customerName",className:"font-medium",children:"Full Name *"}),(0,a.jsx)(F.p,{id:"customerName",value:e5.customerName,onChange:e=>{let t=e.target.value;e3({...e5,customerName:t}),tw("customerName",t)},placeholder:"Enter your full name",className:"h-12 focus-visible:ring-primary"}),eD.customerName&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:eD.customerName})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z.J,{htmlFor:"customerEmail",className:"font-medium",children:"Email Address *"}),(0,a.jsx)(F.p,{id:"customerEmail",type:"email",value:e5.customerEmail,onChange:e=>{let t=e.target.value;e3({...e5,customerEmail:t}),tw("customerEmail",t)},placeholder:"your@email.com",className:"h-12 focus-visible:ring-primary"}),eD.customerEmail&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:eD.customerEmail})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z.J,{htmlFor:"customerPhone",className:"font-medium",children:"Phone Number *"}),(0,a.jsx)(F.p,{id:"customerPhone",type:"tel",value:e5.customerPhone,onChange:e=>{let t=e.target.value;e3({...e5,customerPhone:t}),tw("customerPhone",t)},placeholder:"+1 (555) 123-4567",className:"h-12 focus-visible:ring-primary"}),eD.customerPhone&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:eD.customerPhone})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(z.J,{htmlFor:"customerType",className:"font-medium",children:"Customer Type *"}),(0,a.jsxs)(V.l6,{value:e5.customerType,onValueChange:e=>{e3({...e5,customerType:e}),tw("customerType",e)},children:[(0,a.jsx)(V.bq,{id:"customerType",className:"h-12 focus-visible:ring-primary",children:(0,a.jsx)(V.yv,{placeholder:"Select customer type"})}),(0,a.jsxs)(V.gC,{position:"popper",sideOffset:4,children:[(0,a.jsx)(V.eb,{value:"Individual",children:"Individual"}),(0,a.jsx)(V.eb,{value:"Company",children:"Company"})]})]}),eD.customerType&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:eD.customerType})]})]}),(0,a.jsxs)("div",{className:"border-t border-border/50 pt-6 sm:pt-8",children:[(0,a.jsxs)("h4",{className:"text-base sm:text-lg font-semibold mb-2 flex items-center gap-2",children:["Identity Verification ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsxs)("p",{className:"text-xs sm:text-sm text-muted-foreground mb-4",children:[(0,a.jsx)("strong",{children:"Required:"})," To ensure security and compliance, all customers must complete identity verification before proceeding with their rental."]}),"init"===e9&&(0,a.jsx)("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-3 sm:p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-2 sm:gap-3",children:[(0,a.jsx)(eo.A,{className:"w-5 h-5 text-destructive mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium mb-2 text-destructive",children:"Verification Required"}),(0,a.jsxs)("p",{className:"text-xs sm:text-sm text-muted-foreground mb-4",children:[(0,a.jsx)("strong",{children:"You must verify your identity to continue."})," Please fill in your details above, then click the button below to start the verification process."]}),(0,a.jsx)(L.$,{onClick:tn,disabled:tt||!e5.customerName||!e5.customerEmail||!e5.customerPhone,variant:"outline",className:"border-accent text-accent hover:bg-accent hover:text-white w-full sm:w-auto text-sm",size:"sm",children:tt?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin mr-2"}),(0,a.jsx)("span",{className:"truncate",children:"Starting..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(en.A,{className:"w-4 h-4 mr-2 flex-shrink-0"}),(0,a.jsx)("span",{children:"Start Identity Verification"})]})})]})]})}),"pending"===e9&&(0,a.jsx)("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-3 sm:p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-2 sm:gap-3",children:[(0,a.jsx)(h.A,{className:"w-5 h-5 text-yellow-500 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium mb-2 text-yellow-600 dark:text-yellow-500",children:"Verification Pending"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground mb-2",children:"Your identity verification is in progress. Please complete the verification in the popup window."}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-3",children:"Once verified, you can proceed with your booking. This may take a few moments."}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,a.jsx)(L.$,{onClick:tn,disabled:tt,variant:"outline",className:"border-yellow-500 text-yellow-600 hover:bg-yellow-500 hover:text-white w-full sm:w-auto",size:"sm",children:tt?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin mr-2"}),(0,a.jsx)("span",{children:"Starting..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ec.A,{className:"w-4 h-4 mr-2 flex-shrink-0"}),(0,a.jsx)("span",{children:"Reopen Verification"})]})}),(0,a.jsxs)(L.$,{onClick:to,variant:"ghost",className:"text-muted-foreground hover:text-destructive hover:bg-destructive/10 w-full sm:w-auto",size:"sm",children:[(0,a.jsx)(ei.A,{className:"w-4 h-4 mr-2 flex-shrink-0"}),"Cancel & Start Over"]})]})]})]})}),"verified"===e9&&(0,a.jsx)("div",{className:"bg-green-500/10 border border-green-500/20 rounded-lg p-3 sm:p-4",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex items-start gap-2 sm:gap-3 flex-1",children:[(0,a.jsx)(j.A,{className:"w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium mb-1 text-green-600 dark:text-green-500",children:"Verified"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Your identity has been successfully verified. You can proceed with your booking."})]})]}),(0,a.jsxs)(L.$,{onClick:to,variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive hover:bg-destructive/10 flex-shrink-0 self-start sm:self-auto ml-7 sm:ml-0",title:"Clear verification to verify again",children:[(0,a.jsx)(ei.A,{className:"w-4 h-4 mr-1"}),"Clear"]})]})}),"rejected"===e9&&(0,a.jsx)("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-3 sm:p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-2 sm:gap-3",children:[(0,a.jsx)(ei.A,{className:"w-5 h-5 text-destructive mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium mb-2 text-destructive",children:"Verification Failed"}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground mb-3",children:"Your identity verification was not successful. Please try again or contact support."}),(0,a.jsxs)(L.$,{onClick:tn,disabled:tt,variant:"outline",className:"border-accent text-accent hover:bg-accent hover:text-white w-full sm:w-auto",size:"sm",children:[(0,a.jsx)(en.A,{className:"w-4 h-4 mr-2 flex-shrink-0"}),"Retry Verification"]})]})]})}),eD.verification&&(0,a.jsx)("p",{className:"text-sm text-destructive mt-3 font-medium",children:eD.verification})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[(0,a.jsxs)(L.$,{onClick:()=>m(2),variant:"outline",className:"w-full sm:flex-1 h-11 sm:h-12 border-primary text-primary hover:bg-primary/10 font-semibold text-sm sm:text-base",size:"lg",children:[(0,a.jsx)(et.A,{className:"mr-2 w-4 h-4 sm:w-5 sm:h-5"})," Back"]}),(0,a.jsxs)(L.$,{onClick:t_,disabled:"verified"!==e9,className:"w-full sm:flex-1 h-11 sm:h-12 bg-primary hover:bg-primary/90 text-primary-foreground font-semibold text-sm sm:text-base shadow-md hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",size:"lg",children:[(0,a.jsx)("span",{className:"sm:hidden",children:"Continue"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Continue to Review"}),(0,a.jsx)(ee.A,{className:"ml-2 w-4 h-4 sm:w-5 sm:h-5"})]})]}),"verified"!==e9&&(0,a.jsx)("p",{className:"text-xs sm:text-sm text-destructive text-center mt-2",children:"Please complete identity verification to continue"})]}),4===d&&(0,a.jsx)("div",{className:"animate-fade-in",children:(0,a.jsx)(eR,{formData:e5,selectedVehicle:ty,extras:f,rentalDuration:tu()||{days:1,formatted:"1 day"},vehicleTotal:(null==tN?void 0:tN.total)||0,selectedProtectionPlan:e4,onBack:()=>m(3)})}),(0,a.jsx)(eh,{open:ef,onOpenChange:e=>{ev(e),e||ey.current||ep(!1),e||(ey.current=!1)},customerName:e5.customerName,customerEmail:e5.customerEmail,customerPhone:e5.customerPhone,bookingDetails:"".concat(e5.pickupLocation," → ").concat(e5.dropoffLocation," on ").concat(e5.pickupDate," at ").concat(e5.pickupTime),fullBookingData:{pickupLocation:e5.pickupLocation,dropoffLocation:e5.dropoffLocation,pickupDate:e5.pickupDate,pickupTime:e5.pickupTime,vehicleName:(()=>{let e=u.find(e=>e.id===e5.vehicleId);return e?e.make&&e.model?"".concat(e.make," ").concat(e.model):e.make||e.model||e.reg:"Not selected"})()},onSubmit:e=>{eb(e),ep(!0),ey.current=!0}})]})})]})};var eZ=s(5119);function eB(){var e,t,s,r,o,n,c,d,m,u,x,p,h,f,v,j,b;let[y,N]=(0,P.useState)({avgRating:"5.0",count:"0"}),{data:w}=(0,k.y)("home"),E=(0,k.TP)(w,k.Sz),{settings:T}=(0,R.y)(),F=T.phone.replace(/[^\d+]/g,"");(0,P.useEffect)(()=>{let e=window.location.hash;if(e){let t=document.querySelector(e);t&&setTimeout(()=>{t.scrollIntoView({behavior:"smooth",block:"start"})},100)}},[]),(0,P.useEffect)(()=>{(async()=>{let{data:e,error:t}=await S.N.from("testimonials").select("rating").eq("is_active",!0);!t&&e&&e.length>0&&N({avgRating:(e.reduce((e,t)=>e+(t.rating||5),0)/e.length).toFixed(1),count:e.length.toString()})})()},[]);let z={"@context":"https://schema.org","@type":"LocalBusiness",name:"Drive 917",description:"Premium luxury car rentals in the UK",telephone:"+44-800-123-4567",address:{"@type":"PostalAddress",addressLocality:"London",addressCountry:"UK"},priceRange:"$$$",aggregateRating:{"@type":"AggregateRating",ratingValue:y.avgRating,reviewCount:y.count}};return(0,a.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,a.jsx)(A.A,{title:(null==(e=E.seo)?void 0:e.title)||"Premium Luxury Car Rentals",description:(null==(t=E.seo)?void 0:t.description)||"Rent premium luxury vehicles with Drive917. Flexible daily, weekly, and monthly rates. Top-tier fleet and exceptional service.",keywords:(null==(s=E.seo)?void 0:s.keywords)||"luxury car rental, premium vehicle hire, exotic car rental, Dallas car rental",schema:z}),(0,a.jsx)(i.A,{}),(0,a.jsx)("section",{className:"relative min-h-screen ",children:(0,a.jsx)(eZ.A,{images:["/carousel-images/car1.jpeg","/carousel-images/car2.jpeg","/carousel-images/car3.jpeg","/carousel-images/car4.jpeg","/carousel-images/car9.jpeg"],autoPlayInterval:5e3,overlayStrength:"medium",showScrollIndicator:!0,className:"min-h-screen",children:(0,a.jsxs)("div",{className:"flex items-center justify-center min-h-screen",children:[(0,a.jsx)("div",{className:"container mx-auto px-4",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto text-center space-y-8 animate-fade-in",children:[(0,a.jsx)("h1",{className:"text-5xl sm:text-6xl md:text-7xl lg:text-8xl font-display font-bold text-white leading-tight",children:(null==(r=E.home_hero)?void 0:r.headline)||"Reliable Car Rentals You Can Count On"}),(0,a.jsx)("p",{className:"text-lg md:text-xl lg:text-2xl text-white/90 max-w-3xl mx-auto font-light leading-relaxed",children:(null==(o=E.home_hero)?void 0:o.subheading)||"Quality vehicles. Transparent pricing. Exceptional service."}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center pt-4",children:[(0,a.jsx)("a",{href:"tel:".concat(F),children:(0,a.jsxs)(L.$,{size:"lg",className:"bg-primary hover:bg-primary/90 text-primary-foreground font-semibold text-base md:text-lg px-8 py-6 rounded-md shadow-glow hover:shadow-glow transition-all",children:[(0,a.jsx)(g.A,{className:"w-5 h-5 mr-2"}),"Call ".concat(T.phone_display)]})}),(0,a.jsx)("a",{href:"#booking",children:(0,a.jsx)(L.$,{size:"lg",variant:"outline",className:"bg-transparent border-2 border-white text-white hover:bg-white/10 hover:border-white font-semibold text-base md:text-lg px-8 py-6 rounded-md transition-all",children:(null==(n=E.home_hero)?void 0:n.book_cta_text)||"Book Now"})})]}),(0,a.jsx)("p",{className:"text-sm md:text-base text-white/80 font-medium pt-4",children:(null==(c=E.home_hero)?void 0:c.trust_line)||"Premium Fleet • Flexible Rates • 24/7 Support"})]})}),(null==(d=E.promo_badge)?void 0:d.enabled)!==!1&&(0,a.jsx)("a",{href:"#booking",className:"absolute bottom-12 right-8 md:bottom-16 md:right-16 z-20 group cursor-pointer animate-fade-in",style:{animationDelay:"0.5s"},children:(0,a.jsxs)("div",{className:"relative w-28 h-28 md:w-36 md:h-36 rounded-full bg-primary flex flex-col items-center justify-center shadow-glow group-hover:shadow-glow transition-all duration-300 group-hover:scale-105",children:[(0,a.jsx)("span",{className:"text-2xl md:text-3xl font-bold text-primary-foreground leading-none",children:(null==(m=E.promo_badge)?void 0:m.discount_amount)||"20%"}),(0,a.jsx)("span",{className:"text-xl md:text-2xl font-bold text-primary-foreground leading-none",children:(null==(u=E.promo_badge)?void 0:u.discount_label)||"OFF"}),(0,a.jsx)("span",{className:"text-[9px] md:text-[10px] font-semibold text-primary-foreground/80 mt-1 uppercase tracking-wide",children:(null==(x=E.promo_badge)?void 0:x.line1)||"When You Book"}),(0,a.jsx)("span",{className:"text-[9px] md:text-[10px] font-semibold text-primary-foreground/80 uppercase tracking-wide",children:(null==(p=E.promo_badge)?void 0:p.line2)||"Online"})]})})]})})}),(0,a.jsx)(_,{}),(0,a.jsx)("section",{id:"booking",className:"py-20 bg-muted/20",children:(0,a.jsx)("div",{className:"container mx-auto px-4",children:(0,a.jsx)(eO,{})})}),(0,a.jsx)(D,{}),(0,a.jsx)("section",{className:"py-24 md:py-28 lg:py-32 bg-gradient-to-b from-muted/20 to-muted/30 relative overflow-hidden",children:(0,a.jsx)("div",{className:"container mx-auto px-4 text-center relative z-10",children:(0,a.jsxs)("div",{className:"animate-fade-in",children:[(0,a.jsxs)("div",{className:"text-center space-y-4 mb-8",children:[(0,a.jsx)("h2",{className:"text-4xl md:text-5xl font-display font-bold text-foreground",children:(null==(h=E.home_cta)?void 0:h.title)||"Ready to Book Your Dallas Rental?"}),(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)("div",{className:"h-[1px] w-24 bg-gradient-to-r from-transparent via-primary to-transparent"})})]}),(0,a.jsx)("p",{className:"text-xl text-foreground/80 max-w-3xl mx-auto leading-relaxed text-center",children:(null==(f=E.home_cta)?void 0:f.description)||"Quick, easy, and affordable car rentals across Dallas and the DFW area. Friendly service, transparent pricing, and clean vehicles every time."}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-6 justify-center items-center pt-4",children:[(0,a.jsx)("a",{href:"#booking",children:(0,a.jsx)(L.$,{size:"lg",className:"bg-primary hover:bg-primary/90 text-primary-foreground shadow-md hover:shadow-lg transition-all text-lg px-10 py-7 font-semibold min-w-[200px]",children:(null==(v=E.home_cta)?void 0:v.primary_cta_text)||"Book Now"})}),(0,a.jsx)(l(),{href:"/contact",children:(0,a.jsx)(L.$,{size:"lg",variant:"outline",className:"border-2 border-foreground text-foreground hover:bg-foreground hover:text-background text-lg px-10 py-7 font-semibold min-w-[200px] transition-all",children:(null==(j=E.home_cta)?void 0:j.secondary_cta_text)||"Get in Touch"})})]}),(0,a.jsx)("div",{className:"pt-6 flex items-center justify-center gap-4 text-sm text-muted-foreground flex-wrap",children:((null==(b=E.home_cta)?void 0:b.trust_points)||["Reliable Service","Clean Vehicles","24/7 Support"]).map((e,t)=>(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-primary"}),e]},t))})]})})}),(0,a.jsx)($,{}),(0,a.jsx)(C.A,{}),(0,a.jsx)(I,{}),(0,a.jsx)(M,{})]})}}},e=>{e.O(0,[7615,8864,8720,3894,4258,6379,5282,4844,8133,8522,1731,3232,8441,1255,7358],()=>e(e.s=2847)),_N_E=e.O()}]);